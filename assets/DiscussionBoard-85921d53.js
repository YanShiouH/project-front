import{_ as K,P as O,Q as i,S as b,T as a,c as e,av as N,aw as U,a2 as r,a8 as m,ax as w,ah as C,ak as Q,al as W,M as X,N as Z,L as G,x as u,an as H,aa as J,o as P,R as B,aB as Y,W as T,X as l,K as y,U as ee,Z as ae,ao as te,ap as oe,az as se,a4 as le,a6 as ne,a7 as re}from"./index-060fd7eb.js";import{u as de,a as I}from"./vee-validate.esm-7997461b.js";import{c as ue,a as F,V as ie}from"./index.esm-967266ce.js";import{a as ce}from"./aos-97de04ae.js";import{V as me}from"./VContainer-8d51a515.js";import{V as pe,a as p}from"./VRow-aea40bbf.js";import{V as fe}from"./VPagination-f0fd38ce.js";import{V as _e}from"./VTextarea-b78c244c.js";import"./_commonjsHelpers-725317a4.js";const ge=n=>(Q("data-v-8d1e1d1e"),n=n(),W(),n),Ve=ge(()=>C("br",null,null,-1)),ve={__name:"PostCard",props:{_id:{type:String,default:()=>""},account:{type:String,default:()=>""},date:{type:Date,default:()=>""},title:{type:String,default:()=>""},content:{type:String,default:()=>""}},setup(n){return(h,k)=>{const d=O("router-link");return i(),b(d,{to:"/discussion/"+n._id,class:"text-decoration-none"},{default:a(()=>[e(N,{class:"discussion-card"},{default:a(()=>[e(U,{class:"text-primary"},{default:a(()=>[r(m(n.title),1)]),_:1}),e(w,null,{default:a(()=>[r(m(n.content),1)]),_:1}),e(w,null,{default:a(()=>[r(" Poster: "),C("b",null,m(n.account),1),Ve,r(" "+m(new Date(n.date).toLocaleString("en-US")),1)]),_:1})]),_:1})]),_:1},8,["to"])}}},Se=K(ve,[["__scopeId","data-v-8d1e1d1e"]]),xe=C("h1",{class:"text-center"},"Discussion Board",-1),Te={__name:"DiscussionBoard",setup(n){ce.init();const h=X(),{isLogin:k}=Z(h),d=G(),f=u([]);(async()=>{try{const{data:o}=await H.get("/discussion"),t=o.result.sort((s,x)=>new Date(x.date)-new Date(s.date));f.value.push(...t)}catch(o){d({text:o.response.data.message,showCloseButton:!1,snackbarProps:{timeout:2e3,color:"red",location:"bottom"}})}})();const c=u(!1),M=u(""),q=()=>{M.value="",c.value=!0},D=()=>{c.value=!1,L()},z=ue({title:F().required("Title is required"),content:F().required("Content is required")}),{handleSubmit:A,isSubmitting:_,resetForm:L}=de({validationSchema:z,initialValues:{title:"",content:""}}),g=I("title"),V=I("content"),R=A(async o=>{try{const t=new FormData;t.append("title",o.title),t.append("content",o.content),t.append("date",new Date().toISOString()),await J.post("/discussion",t),d({text:"Submitted successfully",showCloseButton:!1,snackbarProps:{timeout:2e3,color:"green",location:"bottom"}}),D()}catch(t){d({text:t.response.data.message,showCloseButton:!1,snackbarProps:{timeout:2e3,color:"red",location:"bottom"}})}}),v=u(5),S=u(1),$=P(()=>{const o=(S.value-1)*v.value,t=o+v.value;return f.value.slice(o,t)}),j=P(()=>Math.ceil(f.value.length/v.value)),E=o=>o*200;return(o,t)=>(i(),B(T,null,[e(me,null,{default:a(()=>[e(pe,{class:"max-width-1080"},{default:a(()=>[e(p,{cols:"12"},{default:a(()=>[xe]),_:1}),l(k)?(i(),b(p,{key:0,cols:"12",class:"d-flex justify-end"},{default:a(()=>[e(y,{color:"secondary",onClick:q},{default:a(()=>[r("Add New Post")]),_:1})]),_:1})):ee("",!0),(i(!0),B(T,null,ae($.value,(s,x)=>(i(),b(p,{cols:"12",key:s._id,"data-aos":"fade-down","data-aos-duration":"1200","data-aos-delay":E(x),"data-aos-offset":"-100"},{default:a(()=>[e(Se,ne(re(s)),null,16)]),_:2},1032,["data-aos-delay"]))),128)),e(p,{cols:"12"},{default:a(()=>[e(fe,{modelValue:S.value,"onUpdate:modelValue":t[0]||(t[0]=s=>S.value=s),length:j.value,size:"20"},null,8,["modelValue","length"])]),_:1})]),_:1})]),_:1}),e(Y,{persistent:"",modelValue:c.value,"onUpdate:modelValue":t[3]||(t[3]=s=>c.value=s),width:"500px"},{default:a(()=>[e(ie,{disabled:l(_),onSubmit:te(l(R),["prevent"])},{default:a(()=>[e(N,null,{default:a(()=>[e(U,null,{default:a(()=>[r("Add New Post")]),_:1}),e(w,null,{default:a(()=>[e(oe,{label:"Title",modelValue:l(g).value.value,"onUpdate:modelValue":t[1]||(t[1]=s=>l(g).value.value=s),"error-messages":l(g).errorMessage.value},null,8,["modelValue","error-messages"]),e(_e,{label:"Content",modelValue:l(V).value.value,"onUpdate:modelValue":t[2]||(t[2]=s=>l(V).value.value=s),"error-messages":l(V).errorMessage.value},null,8,["modelValue","error-messages"])]),_:1}),e(se,null,{default:a(()=>[e(le),e(y,{color:"error",onClick:D,loading:l(_)},{default:a(()=>[r("Cancel")]),_:1},8,["loading"]),e(y,{color:"primary",type:"submit",loading:l(_)},{default:a(()=>[r("Submit")]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["disabled","onSubmit"])]),_:1},8,["modelValue"])],64))}};export{Te as default};
