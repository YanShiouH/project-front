import{_ as W,Y,Z as p,a0 as w,a1 as t,c as a,ay as A,az as z,a8 as r,ae as v,aA as x,an as b,ap as Z,aq as H,U as J,W as X,T as ee,x as d,as as ae,ag as te,o as T,$ as U,aF as oe,S as F,a3 as s,K as m,a2 as le,au as N,aG as se,a5 as ne,at as re,aD as de,aa as ue,ac as ie,ad as ce}from"./index-2464dbc7.js";import{c as me,a as $,u as pe,d as q}from"./index.esm-2f23a872.js";import{a as fe}from"./aos-97de04ae.js";import{V as ve}from"./VContainer-74dc93a4.js";import{a as ge,V as u}from"./VRow-95f717ca.js";import{V as _e}from"./VPagination-cc0cb513.js";import{V as Ve}from"./VForm-ea6f9526.js";import{V as ye}from"./VTextarea-2f937a55.js";import"./_commonjsHelpers-725317a4.js";const Se=n=>(Z("data-v-8d1e1d1e"),n=n(),H(),n),Ce=Se(()=>b("br",null,null,-1)),we={__name:"PostCard",props:{_id:{type:String,default:()=>""},account:{type:String,default:()=>""},date:{type:Date,default:()=>""},title:{type:String,default:()=>""},content:{type:String,default:()=>""}},setup(n){return(k,D)=>{const i=Y("router-link");return p(),w(i,{to:"/discussion/"+n._id,class:"text-decoration-none"},{default:t(()=>[a(A,{class:"discussion-card"},{default:t(()=>[a(z,{class:"text-primary"},{default:t(()=>[r(v(n.title),1)]),_:1}),a(x,null,{default:t(()=>[r(v(n.content),1)]),_:1}),a(x,null,{default:t(()=>[r(" Poster: "),b("b",null,v(n.account),1),Ce,r(" "+v(new Date(n.date).toLocaleString("en-US")),1)]),_:1})]),_:1})]),_:1},8,["to"])}}},xe=W(we,[["__scopeId","data-v-8d1e1d1e"]]);const be=b("h1",{class:"text-center"},"Discussion Board",-1),Ne={__name:"DiscussionBoard",setup(n){fe.init();const k=J(),{isLogin:D}=X(k),i=ee(),c=d([]),P=d(0);(async()=>{try{const{data:l}=await ae.get("/discussion"),e=l.result.sort((o,C)=>new Date(C.date)-new Date(o.date));c.value.push(...e)}catch(l){i({text:l.response.data.message,showCloseButton:!1,snackbarProps:{timeout:2e3,color:"red",location:"bottom"}})}})();const f=d(!1),M=d(""),L=()=>{M.value="",f.value=!0},h=()=>{f.value=!1,E()},R=me({title:$().required("Title is required"),content:$().required("Content is required")}),{handleSubmit:j,isSubmitting:g,resetForm:E}=pe({validationSchema:R,initialValues:{title:"",content:""}}),_=q("title"),V=q("content"),G=j(async l=>{try{const e=new FormData;e.append("title",l.title),e.append("content",l.content),e.append("date",new Date().toISOString()),await te.post("/discussion",e),i({text:"Submitted successfully",showCloseButton:!1,snackbarProps:{timeout:2e3,color:"green",location:"bottom"}}),h()}catch(e){i({text:e.response.data.message,showCloseButton:!1,snackbarProps:{timeout:2e3,color:"red",location:"bottom"}})}}),y=d(5),S=d(1),K=T(()=>{const l=(S.value-1)*y.value,e=l+y.value;return c.value.slice(l,e)}),O=T(()=>Math.ceil(c.value.length/y.value)),B=d(""),I=async l=>{l==="newest"?c.value.sort((e,o)=>new Date(o.date)-new Date(e.date)):l==="popular"&&c.value.sort((e,o)=>o.comments.length-e.comments.length)},Q=l=>l*200;return(l,e)=>(p(),U(F,null,[a(ve,null,{default:t(()=>[a(ge,{class:"max-width-1080"},{default:t(()=>[a(u,{cols:"12"},{default:t(()=>[be]),_:1}),s(D)?(p(),w(u,{key:0,cols:"12",class:"d-flex justify-end"},{default:t(()=>[a(m,{color:"secondary",onClick:L},{default:t(()=>[r("Add New Post")]),_:1})]),_:1})):le("",!0),a(u,{cols:"5",sm:"8",lg:"9"},{default:t(()=>[a(N,{modelValue:B.value,"onUpdate:modelValue":e[0]||(e[0]=o=>B.value=o),placeholder:"Search...","append-inner-icon":"mdi-magnify",variant:"filled",density:"compact","onClick:appendInner":l.onClick},null,8,["modelValue","onClick:appendInner"])]),_:1}),a(u,{cols:"7",sm:"4",lg:"3",class:"d-flex justify-end"},{default:t(()=>[a(se,{modelValue:P.value,"onUpdate:modelValue":e[3]||(e[3]=o=>P.value=o),divided:"",variant:"outlined"},{default:t(()=>[a(m,{onClick:e[1]||(e[1]=o=>I("newest")),variant:"outlined"},{default:t(()=>[r("Newest")]),_:1}),a(m,{onClick:e[2]||(e[2]=o=>I("popular")),variant:"outlined"},{default:t(()=>[r("Popular")]),_:1})]),_:1},8,["modelValue"])]),_:1}),(p(!0),U(F,null,ne(K.value,(o,C)=>(p(),w(u,{cols:"12",key:o._id,"data-aos":"fade-down","data-aos-duration":"1200","data-aos-delay":Q(C),"data-aos-offset":"-100"},{default:t(()=>[a(xe,ie(ce(o)),null,16)]),_:2},1032,["data-aos-delay"]))),128)),a(u,{cols:"12"},{default:t(()=>[a(_e,{modelValue:S.value,"onUpdate:modelValue":e[4]||(e[4]=o=>S.value=o),length:O.value,size:"20"},null,8,["modelValue","length"])]),_:1})]),_:1})]),_:1}),a(oe,{persistent:"",modelValue:f.value,"onUpdate:modelValue":e[7]||(e[7]=o=>f.value=o),width:"500px"},{default:t(()=>[a(Ve,{disabled:s(g),onSubmit:re(s(G),["prevent"])},{default:t(()=>[a(A,null,{default:t(()=>[a(z,null,{default:t(()=>[r("Add New Post")]),_:1}),a(x,null,{default:t(()=>[a(N,{label:"Title",modelValue:s(_).value.value,"onUpdate:modelValue":e[5]||(e[5]=o=>s(_).value.value=o),"error-messages":s(_).errorMessage.value},null,8,["modelValue","error-messages"]),a(ye,{label:"Content",modelValue:s(V).value.value,"onUpdate:modelValue":e[6]||(e[6]=o=>s(V).value.value=o),"error-messages":s(V).errorMessage.value},null,8,["modelValue","error-messages"])]),_:1}),a(de,null,{default:t(()=>[a(ue),a(m,{color:"error",onClick:h,loading:s(g)},{default:t(()=>[r("Cancel")]),_:1},8,["loading"]),a(m,{color:"primary",type:"submit",loading:s(g),variant:"elevated"},{default:t(()=>[r("Submit")]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["disabled","onSubmit"])]),_:1},8,["modelValue"])],64))}};export{Ne as default};
