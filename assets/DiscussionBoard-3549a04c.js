import{L as M,x as r,aa as U,P as E,Q as N,R as $,c as a,T as l,ay as q,W as j,a9 as G,af as D,aG as H,K as C,Y as o,ae as O,an as Q,al as W,a2 as S,am as Y,aP as z,ak as J,a4 as X,ab as Z}from"./index-2579ce82.js";import{c as ee,a as ae,u as te,d as w,V as le}from"./index.esm-34455bc1.js";import{V as oe}from"./VContainer-7eff615b.js";import{a as se,V as T}from"./VRow-275f2665.js";import{V as re}from"./VTextarea-76282fc3.js";import"./_commonjsHelpers-39b5b250.js";const ne=Z("h1",{class:"text-center"},"Discussion Board",-1),be={__name:"DiscussionBoard",setup(ue){const b=M(),V=r(5),i=r([{key:"name",order:"asc"}]),d=r(1),f=r([]),F=[{title:"User",align:"center",sortable:!0,key:"user"},{title:"Title",align:"center",sortable:!0,key:"title"},{title:"Content",align:"center",sortable:!0,key:"content"},{title:"Date",align:"center",sortable:!0,key:"date"},{title:"Comments",align:"center",sortable:!0,key:"comments.length"},{title:"Status",align:"center",sortable:!0,key:"status"},{title:"Edit",align:"center",sortable:!1,key:"edit"}],y=r(!1),h=r(0),c=r(""),x=()=>{d.value=1,n()},n=async()=>{var s,e;y.value=!0;try{const{data:u}=await U.get("/admin/discussion/all",{params:{page:d.value,itemsPerPage:V.value,sortBy:((s=i.value[0])==null?void 0:s.key)||"_id",sortOrder:((e=i.value[0])==null?void 0:e.order)||"asc",search:c.value}});f.value.splice(0,f.value.length,...u.result.data),h.value=u.result.count}catch(u){b({text:u.response.data.message,showCloseButton:!1,snackbarProps:{timeout:2e3,color:"red",location:"bottom"}})}y.value=!1};n();const A=s=>{P.value=s._id,v.value.value=s.title,g.value.value=s.content,p.value.value=s.status,m.value=!0},m=r(!1),P=r(""),_=()=>{m.value=!1,K()},B=["Pending Approval","Approved","Rejected"],I=ee({category:ae().required("Status is required").test("isCategory",s=>B.includes(s))}),{handleSubmit:R,isSubmitting:k,resetForm:K}=te({validationSchema:I,initialValues:{title:"",content:"",category:""}}),v=w("title"),g=w("content"),p=w("category"),L=R(async s=>{try{const e=new FormData;e.append("status",s.category),await U.patch("/admin/discussion/"+P.value,e),b({text:"Review Completed",showCloseButton:!1,snackbarProps:{timeout:2e3,color:"green",location:"bottom"}}),_(),n()}catch(e){console.log(e),b({text:e.response.data.message,showCloseButton:!1,snackbarProps:{timeout:2e3,color:"red",location:"bottom"}})}});return(s,e)=>{const u=E("v-data-table-server");return N(),$(j,null,[a(oe,null,{default:l(()=>[a(se,null,{default:l(()=>[a(T,{cols:"12"},{default:l(()=>[ne]),_:1}),a(G),a(T,{cols:"12"},{default:l(()=>[a(u,{"items-per-page":V.value,"onUpdate:itemsPerPage":[e[1]||(e[1]=t=>V.value=t),n],"sort-by":i.value,"onUpdate:sortBy":[e[2]||(e[2]=t=>i.value=t),n],page:d.value,"onUpdate:page":[e[3]||(e[3]=t=>d.value=t),n],items:f.value,headers:F,loading:y.value,"items-length":h.value,search:c.value,hover:""},{top:l(()=>[a(D,{label:"Search","append-icon":"mdi-magnify","onClick:append":x,onKeydown:H(x,["enter"]),modelValue:c.value,"onUpdate:modelValue":e[0]||(e[0]=t=>c.value=t)},null,8,["onKeydown","modelValue"])]),"item.edit":l(({item:t})=>[a(C,{icon:"mdi-pencil",onClick:ie=>A(t.raw),variant:"text"},null,8,["onClick"])]),_:2},1032,["items-per-page","sort-by","page","items","loading","items-length","search"])]),_:1})]),_:1})]),_:1}),a(q,{persistent:"",modelValue:m.value,"onUpdate:modelValue":e[7]||(e[7]=t=>m.value=t),width:"500px"},{default:l(()=>[a(le,{disabled:o(k),onSubmit:O(o(L),["prevent"])},{default:l(()=>[a(Q,null,{default:l(()=>[a(W,null,{default:l(()=>[S("Article Review")]),_:1}),a(Y,null,{default:l(()=>[a(D,{label:"Title",modelValue:o(v).value.value,"onUpdate:modelValue":e[4]||(e[4]=t=>o(v).value.value=t),"error-messages":o(v).errorMessage.value,readonly:""},null,8,["modelValue","error-messages"]),a(re,{label:"Content",modelValue:o(g).value.value,"onUpdate:modelValue":e[5]||(e[5]=t=>o(g).value.value=t),"error-messages":o(g).errorMessage.value,readonly:""},null,8,["modelValue","error-messages"]),a(z,{label:"Status",modelValue:o(p).value.value,"onUpdate:modelValue":e[6]||(e[6]=t=>o(p).value.value=t),"error-messages":o(p).errorMessage.value,items:B},null,8,["modelValue","error-messages"])]),_:1}),a(J,null,{default:l(()=>[a(X),a(C,{color:"red",onClick:_,loading:o(k)},{default:l(()=>[S("Cancel")]),_:1},8,["loading"]),a(C,{color:"green",type:"submit",loading:o(k)},{default:l(()=>[S("Submit")]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["disabled","onSubmit"])]),_:1},8,["modelValue"])],64)}}};export{be as default};
