import{_ as w,Q as i,S as d,T as s,c as r,ap as T,ab as u,a8 as c,a2 as o,an as $,ag as k,ah as P,M as L,N,aq as U,L as q,x as V,ad as x,aa as M,P as A,X as l,ae as j,K as z,U as C,R as E,Z as K,W as O,a6 as Q,a7 as W}from"./index-3919ad30.js";import{c as X,a as Z,V as G}from"./index.esm-4b3af0e7.js";import{u as H,a as J}from"./vee-validate.esm-07a8a422.js";import{V as Y}from"./VContainer-b90d38bd.js";import{V as _,a as tt}from"./VRow-33110aff.js";import{V as et}from"./VTextarea-a3d5144d.js";import"./_commonjsHelpers-39b5b250.js";const D=t=>(k("data-v-c831684c"),t=t(),P(),t),at=D(()=>u("br",null,null,-1)),st=D(()=>u("br",null,null,-1)),ot={__name:"CommentCard",props:{_id:{type:String,default:()=>""},account:{type:String,default:()=>""},date:{type:Date,default:()=>""},content:{type:String,default:()=>""}},setup(t){return(h,p)=>(i(),d($,{variant:"text",class:"bgColor"},{default:s(()=>[r(T,null,{default:s(()=>[u("b",null,c(t.account),1),at,o(" "+c(t.content),1),st,o(" "+c(new Date(t.date).toLocaleString("en-US")),1)]),_:1})]),_:1}))}},nt=w(ot,[["__scopeId","data-v-c831684c"]]);const lt=t=>(k("data-v-47ffeffd"),t=t(),P(),t),rt=lt(()=>u("br",null,null,-1)),ct={class:"d-flex justify-end"},ut={class:"login-message"},it={__name:"DiscussionPost",setup(t){const h=L(),{isLogin:p}=N(h),f=U(),v=q(),a=V({_id:"",title:"",content:"",account:"",date:"",status:""}),g=V([]);(async()=>{try{const{data:e}=await x.get("/discussion/"+f.params.id);a.value._id=e.result._id,a.value.title=e.result.title,a.value.content=e.result.content,a.value.account=e.result.account,a.value.status=e.result.status,a.value.date=e.result.date,document.title="Taealam | "+a.value.title,g.value.push(...e.commentResult)}catch(e){v({text:e.response.data.message,showCloseButton:!1,snackbarProps:{timeout:2e3,color:"red",location:"bottom"}})}})();const B=X({content:Z().required("Content is required")}),{handleSubmit:I,isSubmitting:y,resetForm:R}=H({validationSchema:B,initialValues:{content:""}}),b=J("content"),F=I(async e=>{try{const n=new FormData;n.append("content",e.content),n.append("date",new Date().toISOString()),await M.post("/discussion/"+f.params.id,n),v({text:"Submitted successfully",showCloseButton:!1,snackbarProps:{timeout:2e3,color:"green",location:"bottom"}}),R();const{data:S}=await x.get("/discussion/"+f.params.id);g.value=[...S.commentResult]}catch(n){v({text:n.response.data.message,showCloseButton:!1,snackbarProps:{timeout:2e3,color:"red",location:"bottom"}})}});return(e,n)=>{const S=A("router-link");return i(),d(Y,null,{default:s(()=>[r(tt,{class:"max-width-1080"},{default:s(()=>[r(_,{cols:"12"},{default:s(()=>[o(" Poster: "+c(a.value.account),1),rt,o(" "+c(new Date(a.value.date).toLocaleString("en-US"))+" ",1),u("h1",null,c(a.value.title),1),o(" "+c(a.value.content),1)]),_:1}),l(p)?(i(),d(_,{key:0,cols:"12"},{default:s(()=>[r(G,{disabled:l(y),onSubmit:j(l(F),["prevent"])},{default:s(()=>[r(et,{label:"Add a Comment",modelValue:l(b).value.value,"onUpdate:modelValue":n[0]||(n[0]=m=>l(b).value.value=m),"error-messages":l(b).errorMessage.value,variant:"outlined",clearable:"",rows:"2"},null,8,["modelValue","error-messages"]),u("div",ct,[r(z,{color:"primary",type:"submit",loading:l(y)},{default:s(()=>[o("Submit")]),_:1},8,["loading"])])]),_:1},8,["disabled","onSubmit"])]),_:1})):C("",!0),l(p)?C("",!0):(i(),d(_,{key:1,cols:"12",class:"text-center"},{default:s(()=>[u("p",ut,[o("Please "),r(S,{to:"/login",class:"login-link"},{default:s(()=>[o("log in")]),_:1}),o(" to leave a comment.")])]),_:1})),(i(!0),E(O,null,K(g.value,m=>(i(),d(_,{cols:"12",key:m._id},{default:s(()=>[r(nt,Q(W(m)),null,16)]),_:2},1024))),128))]),_:1})]),_:1})}}},bt=w(it,[["__scopeId","data-v-47ffeffd"]]);export{bt as default};
