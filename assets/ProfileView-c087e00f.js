import{p as ee,m as ae,aq as se,g as te,ar as le,u as oe,c as e,M as re,N as ne,x as d,L as ie,O as ue,o as de,a9 as j,P as ce,Q as F,R as D,T as a,as as me,W as pe,_ as M,X as t,K as w,ao as B,a8 as fe,a2 as ve,af as z,ag as E,at as O,a1 as r,ap as y,V as ge,au as P,av as x,aw as C,ah as _,a7 as A,ax as we}from"./index-fe6ede13.js";import{c as ye,a as $,b as _e,u as Ve,d as q,V as W}from"./index.esm-c7f60be3.js";import{V as he,a as be}from"./VNavigationDrawer-2464959c.js";import{V as Pe}from"./VContainer-71627859.js";import{a as K,V as c}from"./VRow-4e41e806.js";import"./_commonjsHelpers-725317a4.js";const xe=ee({...ae(),...se()},"VLayout"),Ce=te()({name:"VLayout",props:xe(),setup(V,o){let{slots:m}=o;const{layoutClasses:h,layoutStyles:p,getLayoutItem:k,items:f,layoutRef:i}=le(V);return oe(()=>{var u;return e("div",{ref:i,class:[h.value,V.class],style:[p.value,V.style]},[(u=m.default)==null?void 0:u.call(m)])}),{getLayoutItem:k,items:f}}});const ke=_("h2",{class:"profile-title"},"Profile",-1),Le=_("h4",{class:"personal-info-title"},"Personal Information",-1),Se=_("h4",{class:"personal-info-title"},"Reset Password",-1),Ue={class:"highlight-number"},Fe={key:0,class:"highlight-number"},De={key:1},Me={class:"highlight-number"},Ie={__name:"ProfileView",setup(V){const o=re(),{avatar:m}=ne(o),h=d(!0),p=ie(),{mobile:k}=ue(),f=de(()=>k.value),i=d(f.value),u=d("profile"),Q=ye({currentPassword:$().required("Password is required"),newPassword:$().required("Password is required").min(4,"Password should have at least 4 characters").max(20,"Password should not exceed 20 characters"),confirmPassword:$().required("Password is required").min(4,"Password should have at least 4 characters").max(20,"Password should not exceed 20 characters").oneOf([_e("newPassword")],"Passwords do not match")}),{handleSubmit:X,isSubmitting:G,resetForm:R}=Ve({validationSchema:Q}),L=q("currentPassword"),S=q("newPassword"),U=q("confirmPassword"),H=X(async n=>{try{await j.patch("/users/reset",{currentPassword:n.currentPassword,newPassword:n.newPassword}),p({text:"Password updated successfully",showCloseButton:!1,snackbarProps:{timeout:2e3,color:"green",location:"bottom"}}),R()}catch(s){p({text:s.response.data.message,showCloseButton:!1,snackbarProps:{timeout:2e3,color:"red",location:"bottom"}})}}),b=d(!1),J=()=>{b.value=!0},T=()=>{b.value=!1,R(),N.value.deleteFileRecord()},v=d([]),I=d([]),N=d(null),Y=async()=>{if(v.value.length!==0)try{const n=new FormData;v.value.length>0&&n.append("image",v.value[0].file);const{data:s}=await j.patch("/users/image",n);o.image=s.result.image,p({text:"Updated Successfully",showCloseButton:!1,snackbarProps:{timeout:2e3,color:"green",location:"bottom"}}),T()}catch(n){p({text:n.response.data.message,showCloseButton:!1,snackbarProps:{timeout:2e3,color:"red",location:"bottom"}})}};return(n,s)=>{const Z=ce("vue-file-agent");return F(),D(pe,null,[e(Ce,{class:"h-100"},{default:a(()=>[e(he,{modelValue:h.value,"onUpdate:modelValue":s[3]||(s[3]=l=>h.value=l),rail:i.value,permanent:"",onClick:s[4]||(s[4]=l=>f.value?i.value=!0:i.value=!1),clipped:f.value},{default:a(()=>[e(M,{"prepend-avatar":t(o).image===void 0?t(m):t(o).image,nav:"",title:"Welcome"},{append:a(()=>[e(w,{variant:"text",icon:"mdi-chevron-left",onClick:s[0]||(s[0]=B(l=>i.value=!i.value,["stop"]))})]),_:1},8,["prepend-avatar"]),e(fe),e(ve,{density:"compact",nav:""},{default:a(()=>[e(M,{"prepend-icon":"mdi-account",title:"Profile",value:"profile",onClick:s[1]||(s[1]=l=>u.value="profile")}),e(M,{"prepend-icon":"mdi-history",title:"My Activity",value:"activity",onClick:s[2]||(s[2]=l=>u.value="activity")})]),_:1})]),_:1},8,["modelValue","rail","clipped"]),e(be,{class:"h-100"},{default:a(()=>[e(Pe,null,{default:a(()=>[z(e(K,{class:"max-width-835"},{default:a(()=>[e(c,{cols:"12",sm:"6"},{default:a(()=>[ke,Le,e(O,{class:"info-label"},{default:a(()=>[r("Account")]),_:1}),e(y,{value:t(o).account,class:"info-input",density:"compact",variant:"outlined",disabled:""},null,8,["value"]),e(O,{class:"info-label"},{default:a(()=>[r("Email")]),_:1}),e(y,{value:t(o).email,class:"info-input",density:"compact",variant:"outlined",disabled:""},null,8,["value"])]),_:1}),e(c,{cols:"12",sm:"6"},{default:a(()=>[e(ge,{src:t(o).image===void 0?t(m):t(o).image,width:"176",height:"176",class:"image",cover:""},null,8,["src"]),e(w,{variant:"text",color:"primary",onClick:J,class:"ms-10"},{default:a(()=>[r("Upload")]),_:1})]),_:1}),e(W,{disabled:t(G),onSubmit:B(t(H),["prevent"])},{default:a(()=>[e(c,{cols:"12"},{default:a(()=>[Se]),_:1}),e(c,{cols:"12"},{default:a(()=>[e(y,{density:"compact",type:"password",modelValue:t(L).value.value,"onUpdate:modelValue":s[5]||(s[5]=l=>t(L).value.value=l),"error-messages":t(L).errorMessage.value,label:"Current password",variant:"outlined",class:"info-input",color:"primary"},null,8,["modelValue","error-messages"]),e(y,{density:"compact",type:"password",modelValue:t(S).value.value,"onUpdate:modelValue":s[6]||(s[6]=l=>t(S).value.value=l),"error-messages":t(S).errorMessage.value,label:"New password",variant:"outlined",class:"info-input",color:"primary"},null,8,["modelValue","error-messages"]),e(y,{density:"compact",type:"password",modelValue:t(U).value.value,"onUpdate:modelValue":s[7]||(s[7]=l=>t(U).value.value=l),"error-messages":t(U).errorMessage.value,label:"Confirm new password",variant:"outlined",class:"info-input",color:"primary"},null,8,["modelValue","error-messages"]),e(w,{color:"primary",type:"submit",rounded:"",width:"300",variant:"tonal"},{default:a(()=>[r("Update")]),_:1})]),_:1})]),_:1},8,["disabled","onSubmit"])]),_:1},512),[[E,u.value==="profile"]]),z(e(K,{class:"max-width-835"},{default:a(()=>[e(c,{cols:"12",sm:"6",lg:"4"},{default:a(()=>[e(P,{class:"text-center",variant:"elevated"},{default:a(()=>[e(x,null,{default:a(()=>[r("Liked Articles")]),_:1}),e(C,null,{default:a(()=>{var l,g;return[_("span",Ue,A(((g=(l=t(o).profile[0])==null?void 0:l.likedArticles)==null?void 0:g.length)||0),1)]}),_:1})]),_:1})]),_:1}),e(c,{cols:"12",sm:"6",lg:"4"},{default:a(()=>[e(P,{class:"text-center",variant:"elevated"},{default:a(()=>[e(x,null,{default:a(()=>[r("Current Lesson")]),_:1}),e(C,null,{default:a(()=>[t(o).profile[0]&&t(o).profile[0].currentLesson!==null?(F(),D("span",Fe,A(t(o).profile[0].currentLesson),1)):(F(),D("p",De,"Start your learning journey now! Choose a lesson to begin."))]),_:1})]),_:1})]),_:1}),e(c,{cols:"12",sm:"6",lg:"4"},{default:a(()=>[e(P,{class:"text-center",variant:"elevated"},{default:a(()=>[e(x,null,{default:a(()=>[r("Posted Posts")]),_:1}),e(C,null,{default:a(()=>{var l,g;return[_("span",Me,A(((g=(l=t(o).profile[0])==null?void 0:l.postedPosts)==null?void 0:g.length)||0),1)]}),_:1})]),_:1})]),_:1})]),_:1},512),[[E,u.value==="activity"]])]),_:1})]),_:1})]),_:1}),e(me,{persistent:"",modelValue:b.value,"onUpdate:modelValue":s[10]||(s[10]=l=>b.value=l),width:"200"},{default:a(()=>[e(W,{onSubmit:B(Y,["prevent"])},{default:a(()=>[e(P,null,{default:a(()=>[e(x,{class:"text-center"},{default:a(()=>[r("Upload Image")]),_:1}),e(C,null,{default:a(()=>[e(Z,{modelValue:v.value,"onUpdate:modelValue":s[8]||(s[8]=l=>v.value=l),"raw-model-value":I.value,"onUpdate:rawModelValue":s[9]||(s[9]=l=>I.value=l),"max-files":1,"max-size":"1MB",accept:"image/jpg,image/jpeg,image/png",multiple:!1,"error-text":{type:"Invalid file format",size:"File is too large"},deletable:"",ref_key:"fileAgent",ref:N},null,8,["modelValue","raw-model-value"])]),_:1}),e(we,{class:"d-flex justify-center"},{default:a(()=>[e(w,{color:"error",onClick:T},{default:a(()=>[r("Cancel")]),_:1}),e(w,{color:"primary",type:"submit",variant:"elevated"},{default:a(()=>[r("Submit")]),_:1})]),_:1})]),_:1})]),_:1},8,["onSubmit"])]),_:1},8,["modelValue"])],64)}}};export{Ie as default};
