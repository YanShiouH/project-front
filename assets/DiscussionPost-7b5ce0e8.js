import{_ as C,Z as d,a0 as i,a1 as s,c as o,aA as U,an as u,ae as c,a8 as n,ay as L,ap as k,aq as D,U as N,W as q,aB as A,T as M,x as V,as as w,ag as j,Y as z,a3 as r,at as E,K,a2 as x,$ as O,a5 as W,S as Y,ac as Z,ad as G}from"./index-2464dbc7.js";import{c as H,a as J,u as Q,d as X}from"./index.esm-2f23a872.js";import{_ as tt}from"./BackButton-336b96d8.js";import{V as et}from"./VContainer-74dc93a4.js";import{V as _,a as at}from"./VRow-95f717ca.js";import{V as st}from"./VForm-ea6f9526.js";import{V as ot}from"./VTextarea-2f937a55.js";import"./_commonjsHelpers-725317a4.js";const P=e=>(k("data-v-c831684c"),e=e(),D(),e),nt=P(()=>u("br",null,null,-1)),lt=P(()=>u("br",null,null,-1)),rt={__name:"CommentCard",props:{_id:{type:String,default:()=>""},account:{type:String,default:()=>""},date:{type:Date,default:()=>""},content:{type:String,default:()=>""}},setup(e){return(y,p)=>(d(),i(L,{variant:"text",class:"bgColor"},{default:s(()=>[o(U,null,{default:s(()=>[u("b",null,c(e.account),1),nt,n(" "+c(e.content),1),lt,n(" "+c(new Date(e.date).toLocaleString("en-US")),1)]),_:1})]),_:1}))}},ct=C(rt,[["__scopeId","data-v-c831684c"]]);const ut=e=>(k("data-v-d1b39f72"),e=e(),D(),e),dt=ut(()=>u("br",null,null,-1)),it={class:"d-flex justify-end"},mt={class:"login-message"},_t={__name:"DiscussionPost",setup(e){const y=N(),{isLogin:p}=q(y),f=A(),v=M(),a=V({_id:"",title:"",content:"",account:"",date:"",status:""}),g=V([]);(async()=>{try{const{data:t}=await w.get("/discussion/"+f.params.id);a.value._id=t.result._id,a.value.title=t.result.title,a.value.content=t.result.content,a.value.account=t.result.account,a.value.status=t.result.status,a.value.date=t.result.date,document.title="Taealam | "+a.value.title,g.value.push(...t.commentResult)}catch(t){v({text:t.response.data.message,showCloseButton:!1,snackbarProps:{timeout:2e3,color:"red",location:"bottom"}})}})();const B=H({content:J().required("Content is required")}),{handleSubmit:$,isSubmitting:h,resetForm:I}=Q({validationSchema:B,initialValues:{content:""}}),b=X("content"),F=$(async t=>{try{const l=new FormData;l.append("content",t.content),l.append("date",new Date().toISOString()),await j.post("/discussion/"+f.params.id,l),v({text:"Submitted successfully",showCloseButton:!1,snackbarProps:{timeout:2e3,color:"green",location:"bottom"}}),I();const{data:S}=await w.get("/discussion/"+f.params.id);g.value=[...S.commentResult]}catch(l){v({text:l.response.data.message,showCloseButton:!1,snackbarProps:{timeout:2e3,color:"red",location:"bottom"}})}}),R=t=>t*50;return(t,l)=>{const S=z("router-link");return d(),i(et,null,{default:s(()=>[o(at,{class:"max-width-1080"},{default:s(()=>[o(_,{cols:"12"},{default:s(()=>[n(" Poster: "+c(a.value.account),1),dt,n(" "+c(new Date(a.value.date).toLocaleString("en-US"))+" ",1),u("h1",null,c(a.value.title),1),n(" "+c(a.value.content),1)]),_:1}),r(p)?(d(),i(_,{key:0,cols:"12"},{default:s(()=>[o(st,{disabled:r(h),onSubmit:E(r(F),["prevent"])},{default:s(()=>[o(ot,{label:"Add a Comment",modelValue:r(b).value.value,"onUpdate:modelValue":l[0]||(l[0]=m=>r(b).value.value=m),"error-messages":r(b).errorMessage.value,variant:"outlined",clearable:"",rows:"2"},null,8,["modelValue","error-messages"]),u("div",it,[o(K,{color:"primary",type:"submit",loading:r(h)},{default:s(()=>[n("Submit")]),_:1},8,["loading"])])]),_:1},8,["disabled","onSubmit"])]),_:1})):x("",!0),r(p)?x("",!0):(d(),i(_,{key:1,cols:"12",class:"text-center"},{default:s(()=>[u("p",mt,[n("Please "),o(S,{to:"/login",class:"login-link"},{default:s(()=>[n("log in")]),_:1}),n(" to leave a comment.")])]),_:1})),(d(!0),O(Y,null,W(g.value,(m,T)=>(d(),i(_,{cols:"12",key:m._id,"data-aos":"fade-down","data-aos-duration":"1200","data-aos-delay":R(T),"data-aos-offset":"-100"},{default:s(()=>[o(ct,Z(G(m)),null,16)]),_:2},1032,["data-aos-delay"]))),128))]),_:1}),o(tt)]),_:1})}}},Vt=C(_t,[["__scopeId","data-v-d1b39f72"]]);export{Vt as default};
