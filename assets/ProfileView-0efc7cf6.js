import{p as ee,m as ae,aq as se,g as te,ar as le,u as oe,c as e,M as re,N as ne,x as d,L as ie,O as ue,o as de,a9 as j,P as ce,Q as D,R as M,T as a,as as me,W as pe,_ as B,X as l,K as w,ao as P,a8 as fe,a2 as ve,af as z,ag as E,at as O,a1 as r,ap as y,V as ge,au as x,av as C,aw as k,ah as _,a7 as $,ax as we}from"./index-fdaf6647.js";import{c as ye,a as A,b as _e,u as Ve,d as q,V as W}from"./index.esm-6cca9bfa.js";import{V as he,a as be}from"./VNavigationDrawer-1fc87842.js";import{V as Pe}from"./VContainer-6902d66b.js";import{a as K,V as c}from"./VRow-9481cc1f.js";import"./_commonjsHelpers-725317a4.js";const xe=ee({...ae(),...se()},"VLayout"),Ce=te()({name:"VLayout",props:xe(),setup(V,o){let{slots:m}=o;const{layoutClasses:h,layoutStyles:p,getLayoutItem:L,items:f,layoutRef:n}=le(V);return oe(()=>{var u;return e("div",{ref:n,class:[h.value,V.class],style:[p.value,V.style]},[(u=m.default)==null?void 0:u.call(m)])}),{getLayoutItem:L,items:f}}});const ke=_("h2",{class:"profile-title"},"Profile",-1),Le=_("h4",{class:"personal-info-title"},"Personal Information",-1),Se=_("h4",{class:"personal-info-title"},"Reset Password",-1),Ue={class:"highlight-number"},Fe={key:0,class:"highlight-number"},De={key:1},Me={class:"highlight-number"},Ie={__name:"ProfileView",setup(V){const o=re(),{avatar:m}=ne(o),h=d(!0),p=ie(),{mobile:L}=ue(),f=de(()=>L.value),n=d(f.value),u=d("profile"),Q=ye({currentPassword:A().required("Password is required"),newPassword:A().required("Password is required").min(4,"Password should have at least 4 characters").max(20,"Password should not exceed 20 characters"),confirmPassword:A().required("Password is required").min(4,"Password should have at least 4 characters").max(20,"Password should not exceed 20 characters").oneOf([_e("newPassword")],"Passwords do not match")}),{handleSubmit:X,isSubmitting:G,resetForm:R}=Ve({validationSchema:Q}),S=q("currentPassword"),U=q("newPassword"),F=q("confirmPassword"),H=X(async i=>{try{await j.patch("/users/reset",{currentPassword:i.currentPassword,newPassword:i.newPassword}),p({text:"Password updated successfully",showCloseButton:!1,snackbarProps:{timeout:2e3,color:"green",location:"bottom"}}),R()}catch(s){p({text:s.response.data.message,showCloseButton:!1,snackbarProps:{timeout:2e3,color:"red",location:"bottom"}})}}),b=d(!1),J=()=>{b.value=!0},T=()=>{b.value=!1,R(),N.value.deleteFileRecord()},v=d([]),I=d([]),N=d(null),Y=async()=>{if(v.value.length!==0)try{const i=new FormData;v.value.length>0&&i.append("image",v.value[0].file);const{data:s}=await j.patch("/users/image",i);o.image=s.result.image,p({text:"Updated Successfully",showCloseButton:!1,snackbarProps:{timeout:2e3,color:"green",location:"bottom"}}),T()}catch(i){p({text:i.response.data.message,showCloseButton:!1,snackbarProps:{timeout:2e3,color:"red",location:"bottom"}})}};return(i,s)=>{const Z=ce("vue-file-agent");return D(),M(pe,null,[e(Ce,{class:"h-100"},{default:a(()=>[e(he,{modelValue:h.value,"onUpdate:modelValue":s[3]||(s[3]=t=>h.value=t),rail:n.value,permanent:"",onClick:s[4]||(s[4]=t=>f.value?n.value=!0:n.value=!1),clipped:f.value},{default:a(()=>[e(B,{"prepend-avatar":l(o).image===void 0?l(m):l(o).image,nav:"",title:"Welcome"},{append:a(()=>[e(w,{variant:"text",icon:"mdi-chevron-left",onClick:s[0]||(s[0]=P(t=>n.value=!n.value,["stop"]))})]),_:1},8,["prepend-avatar"]),e(fe),e(ve,{density:"compact",nav:""},{default:a(()=>[e(B,{"prepend-icon":"mdi-account",title:"Profile",value:"profile",onClick:s[1]||(s[1]=t=>u.value="profile")}),e(B,{"prepend-icon":"mdi-history",title:"My Activity",value:"activity",onClick:s[2]||(s[2]=t=>u.value="activity")})]),_:1})]),_:1},8,["modelValue","rail","clipped"]),e(be,{class:"h-100",onClick:s[8]||(s[8]=P(t=>n.value=!0,["stop"]))},{default:a(()=>[e(Pe,null,{default:a(()=>[z(e(K,{class:"max-width-835"},{default:a(()=>[e(c,{cols:"12",sm:"6"},{default:a(()=>[ke,Le,e(O,{class:"info-label"},{default:a(()=>[r("Account")]),_:1}),e(y,{value:l(o).account,class:"info-input",density:"compact",variant:"outlined",disabled:""},null,8,["value"]),e(O,{class:"info-label"},{default:a(()=>[r("Email")]),_:1}),e(y,{value:l(o).email,class:"info-input",density:"compact",variant:"outlined",disabled:""},null,8,["value"])]),_:1}),e(c,{cols:"12",sm:"6"},{default:a(()=>[e(ge,{src:l(o).image===void 0?l(m):l(o).image,width:"176",height:"176",class:"image",cover:""},null,8,["src"]),e(w,{variant:"text",color:"primary",onClick:J,class:"ms-10"},{default:a(()=>[r("Upload")]),_:1})]),_:1}),e(W,{disabled:l(G),onSubmit:P(l(H),["prevent"])},{default:a(()=>[e(c,{cols:"12"},{default:a(()=>[Se]),_:1}),e(c,{cols:"12"},{default:a(()=>[e(y,{density:"compact",type:"password",modelValue:l(S).value.value,"onUpdate:modelValue":s[5]||(s[5]=t=>l(S).value.value=t),"error-messages":l(S).errorMessage.value,label:"Current password",variant:"outlined",class:"info-input",color:"primary"},null,8,["modelValue","error-messages"]),e(y,{density:"compact",type:"password",modelValue:l(U).value.value,"onUpdate:modelValue":s[6]||(s[6]=t=>l(U).value.value=t),"error-messages":l(U).errorMessage.value,label:"New password",variant:"outlined",class:"info-input",color:"primary"},null,8,["modelValue","error-messages"]),e(y,{density:"compact",type:"password",modelValue:l(F).value.value,"onUpdate:modelValue":s[7]||(s[7]=t=>l(F).value.value=t),"error-messages":l(F).errorMessage.value,label:"Confirm new password",variant:"outlined",class:"info-input",color:"primary"},null,8,["modelValue","error-messages"]),e(w,{color:"primary",type:"submit",rounded:"",width:"300",variant:"tonal"},{default:a(()=>[r("Update")]),_:1})]),_:1})]),_:1},8,["disabled","onSubmit"])]),_:1},512),[[E,u.value==="profile"]]),z(e(K,{class:"max-width-835"},{default:a(()=>[e(c,{cols:"12",sm:"6",lg:"4"},{default:a(()=>[e(x,{class:"text-center",variant:"elevated"},{default:a(()=>[e(C,null,{default:a(()=>[r("Liked Articles")]),_:1}),e(k,null,{default:a(()=>{var t,g;return[_("span",Ue,$(((g=(t=l(o).profile[0])==null?void 0:t.likedArticles)==null?void 0:g.length)||0),1)]}),_:1})]),_:1})]),_:1}),e(c,{cols:"12",sm:"6",lg:"4"},{default:a(()=>[e(x,{class:"text-center",variant:"elevated"},{default:a(()=>[e(C,null,{default:a(()=>[r("Current Lesson")]),_:1}),e(k,null,{default:a(()=>[l(o).profile[0]&&l(o).profile[0].currentLesson!==null?(D(),M("span",Fe,$(l(o).profile[0].currentLesson),1)):(D(),M("p",De,"Start your learning journey now! Choose a lesson to begin."))]),_:1})]),_:1})]),_:1}),e(c,{cols:"12",sm:"6",lg:"4"},{default:a(()=>[e(x,{class:"text-center",variant:"elevated"},{default:a(()=>[e(C,null,{default:a(()=>[r("Posted Posts")]),_:1}),e(k,null,{default:a(()=>{var t,g;return[_("span",Me,$(((g=(t=l(o).profile[0])==null?void 0:t.postedPosts)==null?void 0:g.length)||0),1)]}),_:1})]),_:1})]),_:1})]),_:1},512),[[E,u.value==="activity"]])]),_:1})]),_:1})]),_:1}),e(me,{persistent:"",modelValue:b.value,"onUpdate:modelValue":s[11]||(s[11]=t=>b.value=t),width:"200"},{default:a(()=>[e(W,{onSubmit:P(Y,["prevent"])},{default:a(()=>[e(x,null,{default:a(()=>[e(C,{class:"text-center"},{default:a(()=>[r("Upload Image")]),_:1}),e(k,null,{default:a(()=>[e(Z,{modelValue:v.value,"onUpdate:modelValue":s[9]||(s[9]=t=>v.value=t),"raw-model-value":I.value,"onUpdate:rawModelValue":s[10]||(s[10]=t=>I.value=t),"max-files":1,"max-size":"1MB",accept:"image/jpg,image/jpeg,image/png",multiple:!1,"error-text":{type:"Invalid file format",size:"File is too large"},deletable:"",ref_key:"fileAgent",ref:N},null,8,["modelValue","raw-model-value"])]),_:1}),e(we,{class:"d-flex justify-center"},{default:a(()=>[e(w,{color:"error",onClick:T},{default:a(()=>[r("Cancel")]),_:1}),e(w,{color:"primary",type:"submit",variant:"elevated"},{default:a(()=>[r("Submit")]),_:1})]),_:1})]),_:1})]),_:1},8,["onSubmit"])]),_:1},8,["modelValue"])],64)}}};export{Ie as default};
