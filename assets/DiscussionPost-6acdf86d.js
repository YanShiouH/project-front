import{_ as C,Q as i,S as d,T as s,c,au as L,ah as u,a8 as r,a2 as o,as as N,aj as k,ak as P,M as U,N as M,av as j,L as q,x as V,am as w,aa as A,P as z,X as l,an as E,K,U as x,R as O,Z as Q,W,a6 as X,a7 as Z}from"./index-546107a1.js";import{c as G,a as H,u as J,d as Y,V as tt}from"./index.esm-95a4c6c7.js";import{V as et}from"./VContainer-12d4fb26.js";import{V as _,a as at}from"./VRow-ffbd189e.js";import{V as st}from"./VTextarea-8e6ca934.js";import"./_commonjsHelpers-725317a4.js";const D=e=>(k("data-v-c831684c"),e=e(),P(),e),ot=D(()=>u("br",null,null,-1)),nt=D(()=>u("br",null,null,-1)),lt={__name:"CommentCard",props:{_id:{type:String,default:()=>""},account:{type:String,default:()=>""},date:{type:Date,default:()=>""},content:{type:String,default:()=>""}},setup(e){return(h,p)=>(i(),d(N,{variant:"text",class:"bgColor"},{default:s(()=>[c(L,null,{default:s(()=>[u("b",null,r(e.account),1),ot,o(" "+r(e.content),1),nt,o(" "+r(new Date(e.date).toLocaleString("en-US")),1)]),_:1})]),_:1}))}},ct=C(lt,[["__scopeId","data-v-c831684c"]]);const rt=e=>(k("data-v-632b9be2"),e=e(),P(),e),ut=rt(()=>u("br",null,null,-1)),it={class:"d-flex justify-end"},dt={class:"login-message"},mt={__name:"DiscussionPost",setup(e){const h=U(),{isLogin:p}=M(h),f=j(),v=q(),a=V({_id:"",title:"",content:"",account:"",date:"",status:""}),b=V([]);(async()=>{try{const{data:t}=await w.get("/discussion/"+f.params.id);a.value._id=t.result._id,a.value.title=t.result.title,a.value.content=t.result.content,a.value.account=t.result.account,a.value.status=t.result.status,a.value.date=t.result.date,document.title="Taealam | "+a.value.title,b.value.push(...t.commentResult)}catch(t){v({text:t.response.data.message,showCloseButton:!1,snackbarProps:{timeout:2e3,color:"red",location:"bottom"}})}})();const B=G({content:H().required("Content is required")}),{handleSubmit:I,isSubmitting:y,resetForm:R}=J({validationSchema:B,initialValues:{content:""}}),g=Y("content"),F=I(async t=>{try{const n=new FormData;n.append("content",t.content),n.append("date",new Date().toISOString()),await A.post("/discussion/"+f.params.id,n),v({text:"Submitted successfully",showCloseButton:!1,snackbarProps:{timeout:2e3,color:"green",location:"bottom"}}),R();const{data:S}=await w.get("/discussion/"+f.params.id);b.value=[...S.commentResult]}catch(n){v({text:n.response.data.message,showCloseButton:!1,snackbarProps:{timeout:2e3,color:"red",location:"bottom"}})}}),T=t=>t*50;return(t,n)=>{const S=z("router-link");return i(),d(et,null,{default:s(()=>[c(at,{class:"max-width-1080"},{default:s(()=>[c(_,{cols:"12"},{default:s(()=>[o(" Poster: "+r(a.value.account),1),ut,o(" "+r(new Date(a.value.date).toLocaleString("en-US"))+" ",1),u("h1",null,r(a.value.title),1),o(" "+r(a.value.content),1)]),_:1}),l(p)?(i(),d(_,{key:0,cols:"12"},{default:s(()=>[c(tt,{disabled:l(y),onSubmit:E(l(F),["prevent"])},{default:s(()=>[c(st,{label:"Add a Comment",modelValue:l(g).value.value,"onUpdate:modelValue":n[0]||(n[0]=m=>l(g).value.value=m),"error-messages":l(g).errorMessage.value,variant:"outlined",clearable:"",rows:"2"},null,8,["modelValue","error-messages"]),u("div",it,[c(K,{color:"primary",type:"submit",loading:l(y)},{default:s(()=>[o("Submit")]),_:1},8,["loading"])])]),_:1},8,["disabled","onSubmit"])]),_:1})):x("",!0),l(p)?x("",!0):(i(),d(_,{key:1,cols:"12",class:"text-center"},{default:s(()=>[u("p",dt,[o("Please "),c(S,{to:"/login",class:"login-link"},{default:s(()=>[o("log in")]),_:1}),o(" to leave a comment.")])]),_:1})),(i(!0),O(W,null,Q(b.value,(m,$)=>(i(),d(_,{cols:"12",key:m._id,"data-aos":"fade-down","data-aos-duration":"1200","data-aos-delay":T($),"data-aos-offset":"-100"},{default:s(()=>[c(ct,X(Z(m)),null,16)]),_:2},1032,["data-aos-delay"]))),128))]),_:1})]),_:1})}}},St=C(mt,[["__scopeId","data-v-632b9be2"]]);export{St as default};
