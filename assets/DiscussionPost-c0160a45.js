import{_ as w,Q as i,S as d,T as s,c,ap as T,ab as u,a8 as r,a2 as o,an as $,ag as k,ah as P,M as L,N,aq as U,L as q,x as V,ad as x,aa as M,P as A,X as l,ae as j,K as z,U as C,R as E,Z as K,W as O,a6 as Q,a7 as W}from"./index-a29906e6.js";import{c as X,a as Z,u as G,d as H,V as J}from"./index.esm-694daa75.js";import{V as Y}from"./VContainer-163c2acf.js";import{V as _,a as ee}from"./VRow-2e6d53ad.js";import{V as te}from"./VTextarea-7e2581f9.js";import"./_commonjsHelpers-39b5b250.js";const D=e=>(k("data-v-c831684c"),e=e(),P(),e),ae=D(()=>u("br",null,null,-1)),se=D(()=>u("br",null,null,-1)),oe={__name:"CommentCard",props:{_id:{type:String,default:()=>""},account:{type:String,default:()=>""},date:{type:Date,default:()=>""},content:{type:String,default:()=>""}},setup(e){return(h,p)=>(i(),d($,{variant:"text",class:"bgColor"},{default:s(()=>[c(T,null,{default:s(()=>[u("b",null,r(e.account),1),ae,o(" "+r(e.content),1),se,o(" "+r(new Date(e.date).toLocaleString("en-US")),1)]),_:1})]),_:1}))}},ne=w(oe,[["__scopeId","data-v-c831684c"]]);const le=e=>(k("data-v-47ffeffd"),e=e(),P(),e),ce=le(()=>u("br",null,null,-1)),re={class:"d-flex justify-end"},ue={class:"login-message"},ie={__name:"DiscussionPost",setup(e){const h=L(),{isLogin:p}=N(h),f=U(),v=q(),a=V({_id:"",title:"",content:"",account:"",date:"",status:""}),g=V([]);(async()=>{try{const{data:t}=await x.get("/discussion/"+f.params.id);a.value._id=t.result._id,a.value.title=t.result.title,a.value.content=t.result.content,a.value.account=t.result.account,a.value.status=t.result.status,a.value.date=t.result.date,document.title="Taealam | "+a.value.title,g.value.push(...t.commentResult)}catch(t){v({text:t.response.data.message,showCloseButton:!1,snackbarProps:{timeout:2e3,color:"red",location:"bottom"}})}})();const B=X({content:Z().required("Content is required")}),{handleSubmit:I,isSubmitting:y,resetForm:R}=G({validationSchema:B,initialValues:{content:""}}),b=H("content"),F=I(async t=>{try{const n=new FormData;n.append("content",t.content),n.append("date",new Date().toISOString()),await M.post("/discussion/"+f.params.id,n),v({text:"Submitted successfully",showCloseButton:!1,snackbarProps:{timeout:2e3,color:"green",location:"bottom"}}),R();const{data:S}=await x.get("/discussion/"+f.params.id);g.value=[...S.commentResult]}catch(n){v({text:n.response.data.message,showCloseButton:!1,snackbarProps:{timeout:2e3,color:"red",location:"bottom"}})}});return(t,n)=>{const S=A("router-link");return i(),d(Y,null,{default:s(()=>[c(ee,{class:"max-width-1080"},{default:s(()=>[c(_,{cols:"12"},{default:s(()=>[o(" Poster: "+r(a.value.account),1),ce,o(" "+r(new Date(a.value.date).toLocaleString("en-US"))+" ",1),u("h1",null,r(a.value.title),1),o(" "+r(a.value.content),1)]),_:1}),l(p)?(i(),d(_,{key:0,cols:"12"},{default:s(()=>[c(J,{disabled:l(y),onSubmit:j(l(F),["prevent"])},{default:s(()=>[c(te,{label:"Add a Comment",modelValue:l(b).value.value,"onUpdate:modelValue":n[0]||(n[0]=m=>l(b).value.value=m),"error-messages":l(b).errorMessage.value,variant:"outlined",clearable:"",rows:"2"},null,8,["modelValue","error-messages"]),u("div",re,[c(z,{color:"primary",type:"submit",loading:l(y)},{default:s(()=>[o("Submit")]),_:1},8,["loading"])])]),_:1},8,["disabled","onSubmit"])]),_:1})):C("",!0),l(p)?C("",!0):(i(),d(_,{key:1,cols:"12",class:"text-center"},{default:s(()=>[u("p",ue,[o("Please "),c(S,{to:"/login",class:"login-link"},{default:s(()=>[o("log in")]),_:1}),o(" to leave a comment.")])]),_:1})),(i(!0),E(O,null,K(g.value,m=>(i(),d(_,{cols:"12",key:m._id},{default:s(()=>[c(ne,Q(W(m)),null,16)]),_:2},1024))),128))]),_:1})]),_:1})}}},ge=w(ie,[["__scopeId","data-v-47ffeffd"]]);export{ge as default};
