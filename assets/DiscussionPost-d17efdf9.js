import{_ as C,Q as d,S as i,T as s,c,ap as T,ab as u,a8 as r,a2 as o,ak as $,ag as k,ah as P,M as L,N,al as U,L as M,x as V,ad as x,aa as q,P as A,X as l,ae as j,K as z,U as w,R as E,Z as K,W as O,a6 as Q,a7 as W}from"./index-dfa05f82.js";import{c as X,a as Z,u as G,d as H,V as J}from"./index.esm-f6a188cd.js";import{V as Y}from"./VContainer-cfd36b17.js";import{V as _,a as tt}from"./VRow-e8da1e55.js";import{V as et}from"./VTextarea-b91cc5e9.js";import"./_commonjsHelpers-39b5b250.js";const D=t=>(k("data-v-17ca71ca"),t=t(),P(),t),at=D(()=>u("br",null,null,-1)),st=D(()=>u("br",null,null,-1)),ot={__name:"CommentCard",props:{_id:{type:String,default:()=>""},account:{type:String,default:()=>""},date:{type:Date,default:()=>""},content:{type:String,default:()=>""}},setup(t){return(h,p)=>(d(),i($,{variant:"text",class:"bgColor"},{default:s(()=>[c(T,null,{default:s(()=>[u("b",null,r(t.account),1),at,o(" "+r(t.content),1),st,o(" "+r(new Date(t.date).toLocaleString("en-US")),1)]),_:1})]),_:1}))}},nt=C(ot,[["__scopeId","data-v-17ca71ca"]]);const lt=t=>(k("data-v-f517cdd8"),t=t(),P(),t),ct=lt(()=>u("br",null,null,-1)),rt={class:"d-flex justify-end"},ut={class:"login-message"},dt={__name:"DiscussionPost",setup(t){const h=L(),{isLogin:p}=N(h),f=U(),v=M(),a=V({_id:"",title:"",content:"",account:"",date:"",status:""}),g=V([]);(async()=>{try{const{data:e}=await x.get("/discussion/"+f.params.id);a.value._id=e.result._id,a.value.title=e.result.title,a.value.content=e.result.content,a.value.account=e.result.account,a.value.status=e.result.status,a.value.date=e.result.date,document.title="Taealam | "+a.value.title,g.value.push(...e.commentResult)}catch(e){v({text:e.response.data.message,showCloseButton:!1,snackbarProps:{timeout:2e3,color:"red",location:"bottom"}})}})();const B=X({content:Z().required("Content is required")}),{handleSubmit:I,isSubmitting:y,resetForm:R}=G({validationSchema:B,initialValues:{content:""}}),b=H("content"),F=I(async e=>{try{const n=new FormData;n.append("content",e.content),n.append("date",new Date().toISOString()),await q.post("/discussion/"+f.params.id,n),v({text:"Submitted successfully",showCloseButton:!1,snackbarProps:{timeout:2e3,color:"green",location:"bottom"}}),R();const{data:S}=await x.get("/discussion/"+f.params.id);g.value=[...S.commentResult]}catch(n){v({text:n.response.data.message,showCloseButton:!1,snackbarProps:{timeout:2e3,color:"red",location:"bottom"}})}});return(e,n)=>{const S=A("router-link");return d(),i(Y,null,{default:s(()=>[c(tt,{class:"max-width-1080 bdc"},{default:s(()=>[c(_,{cols:"12"},{default:s(()=>[o(" Poster: "+r(a.value.account),1),ct,o(" "+r(new Date(a.value.date).toLocaleString("en-US"))+" ",1),u("h1",null,r(a.value.title),1),o(" "+r(a.value.content),1)]),_:1}),l(p)?(d(),i(_,{key:0,cols:"12"},{default:s(()=>[c(J,{disabled:l(y),onSubmit:j(l(F),["prevent"])},{default:s(()=>[c(et,{label:"Add a Comment",modelValue:l(b).value.value,"onUpdate:modelValue":n[0]||(n[0]=m=>l(b).value.value=m),"error-messages":l(b).errorMessage.value,variant:"outlined",clearable:"",rows:"2"},null,8,["modelValue","error-messages"]),u("div",rt,[c(z,{color:"primary",type:"submit",loading:l(y)},{default:s(()=>[o("Submit")]),_:1},8,["loading"])])]),_:1},8,["disabled","onSubmit"])]),_:1})):w("",!0),l(p)?w("",!0):(d(),i(_,{key:1,cols:"12",class:"text-center"},{default:s(()=>[u("p",ut,[o("Please "),c(S,{to:"/login",class:"login-link"},{default:s(()=>[o("log in")]),_:1}),o(" to leave a comment.")])]),_:1})),(d(!0),E(O,null,K(g.value,m=>(d(),i(_,{cols:"12",key:m._id},{default:s(()=>[c(nt,Q(W(m)),null,16)]),_:2},1024))),128))]),_:1})]),_:1})}}},gt=C(dt,[["__scopeId","data-v-f517cdd8"]]);export{gt as default};
