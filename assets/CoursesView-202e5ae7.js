import{T as Q,x as r,ag as U,Y as W,Z as C,$ as F,c as l,a1 as s,aF as X,S as $,af as ee,K as h,a8 as k,au as _,b1 as ae,V as le,a0 as I,a2 as te,a3 as t,at as se,ay as oe,az as re,ae as ne,aA as ue,a5 as ie,aD as de,aa as ce,an as pe,R as me}from"./index-2464dbc7.js";import{c as ve,a as w,e as ge,f as be,u as Ve,g as fe,d as S}from"./index.esm-2f23a872.js";import{V as ye}from"./VContainer-74dc93a4.js";import{a as Ce,V as L}from"./VRow-95f717ca.js";import{V as he}from"./VForm-ea6f9526.js";import{V as ke}from"./VTextarea-2f937a55.js";import{V as _e}from"./VCheckbox-4a07be00.js";import"./_commonjsHelpers-725317a4.js";const we=pe("h1",{class:"text-center"},"Courses",-1),Ae={__name:"CoursesView",setup(Se){const p=Q(),x=r(5),m=r([{key:"lessonNo",order:"asc"}]),v=r(1),N=r([]),M=[{title:"Lesson No.",align:"center",sortable:!0,key:"lessonNo"},{title:"Topic",align:"center",sortable:!0,key:"topic"},{title:"Description",align:"center",sortable:!0,key:"description"},{title:"Content",align:"center",sortable:!0,key:"content"},{title:"Publish",align:"center",sortable:!0,key:"publish"},{title:"Edit",align:"center",sortable:!1,key:"edit"}],P=r(!1),D=r(0),g=r(""),T=()=>{v.value=1,n()},n=async()=>{var o,a;P.value=!0;try{const{data:u}=await U.get("/courses/all",{params:{page:v.value,itemsPerPage:x.value,sortBy:((o=m.value[0])==null?void 0:o.key)||"lessonNo",sortOrder:((a=m.value[0])==null?void 0:a.order)||"asc",search:g.value}});N.value.splice(0,N.value.length,...u.result.data),D.value=u.result.count}catch(u){p({text:u.response.data.message,showCloseButton:!1,snackbarProps:{timeout:2e3,color:"red",location:"bottom"}})}P.value=!1};n();const E=o=>{d.value=o._id,b.value.value=o.lessonNo,f.value.value=o.topic,V.value.value=o.description,G(o.content),y.value.value=o.publish,i.value=!0},i=r(!1),d=r(""),K=()=>{d.value="",i.value=!0},q=()=>{i.value=!1,z()},O=ve({lessonNo:w().required("Lesson No. is required"),topic:w().required("Topic is required"),description:w().required("Description is required"),content:ge().of(w().required("Content is required")),publish:be()}),{handleSubmit:R,isSubmitting:B,resetForm:z,errors:H}=Ve({validationSchema:O,initialValues:{lessonNo:"",topic:"",description:"",content:[""],publish:!1},validateOnMount:!1}),{remove:Y,push:Z,fields:j,replace:G}=fe("content"),b=S("lessonNo"),V=S("description"),f=S("topic"),y=S("publish"),J=R(async o=>{try{d.value.length>0?(await U.patch("/courses/"+d.value,o),p({text:"Updated Successfully",showCloseButton:!1,snackbarProps:{timeout:2e3,color:"green",location:"bottom"}})):(await U.post("/courses",o),p({text:"Added Successfully",showCloseButton:!1,snackbarProps:{timeout:2e3,color:"green",location:"bottom"}})),q(),n()}catch(a){p({text:a.response.data.message,showCloseButton:!1,snackbarProps:{timeout:2e3,color:"red",location:"bottom"}})}});return(o,a)=>{const u=W("v-data-table-server");return C(),F($,null,[l(ye,null,{default:s(()=>[l(Ce,null,{default:s(()=>[l(L,{cols:"12"},{default:s(()=>[we]),_:1}),l(ee),l(L,{cols:"12"},{default:s(()=>[l(h,{color:"green",onClick:K},{default:s(()=>[k("Add Course")]),_:1}),l(u,{"items-per-page":x.value,"onUpdate:itemsPerPage":[a[1]||(a[1]=e=>x.value=e),n],"sort-by":m.value,"onUpdate:sortBy":[a[2]||(a[2]=e=>m.value=e),n],page:v.value,"onUpdate:page":[a[3]||(a[3]=e=>v.value=e),n],items:N.value,headers:M,loading:P.value,"items-length":D.value,search:g.value,hover:""},{top:s(()=>[l(_,{label:"Search","append-icon":"mdi-magnify","onClick:append":T,onKeydown:ae(T,["enter"]),modelValue:g.value,"onUpdate:modelValue":a[0]||(a[0]=e=>g.value=e)},null,8,["onKeydown","modelValue"])]),"item.image":s(({item:e})=>[l(le,{src:e.raw.image,height:"50px"},null,8,["src"])]),"item.publish":s(({item:e})=>[e.raw.publish?(C(),I(me,{key:0,icon:"mdi-check"})):te("",!0)]),"item.edit":s(({item:e})=>[l(h,{icon:"mdi-pencil",onClick:c=>E(e.raw),variant:"text"},null,8,["onClick"])]),_:2},1032,["items-per-page","sort-by","page","items","loading","items-length","search"])]),_:1})]),_:1})]),_:1}),l(X,{persistent:"",modelValue:i.value,"onUpdate:modelValue":a[8]||(a[8]=e=>i.value=e),width:"500px"},{default:s(()=>[l(he,{disabled:t(B),onSubmit:se(t(J),["prevent"])},{default:s(()=>[l(oe,{class:"dialog-card"},{default:s(()=>[l(re,null,{default:s(()=>[k(ne(d.value.length>0?"Edit Course":"Add Course"),1)]),_:1}),l(ue,null,{default:s(()=>[l(_,{label:"Lesson No.",modelValue:t(b).value.value,"onUpdate:modelValue":a[4]||(a[4]=e=>t(b).value.value=e),"error-messages":t(b).errorMessage.value},null,8,["modelValue","error-messages"]),l(_,{label:"Topic",modelValue:t(f).value.value,"onUpdate:modelValue":a[5]||(a[5]=e=>t(f).value.value=e),"error-messages":t(f).errorMessage.value},null,8,["modelValue","error-messages"]),l(ke,{label:"Description",modelValue:t(V).value.value,"onUpdate:modelValue":a[6]||(a[6]=e=>t(V).value.value=e),"error-messages":t(V).errorMessage.value},null,8,["modelValue","error-messages"]),(C(!0),F($,null,ie(t(j),(e,c)=>(C(),I(_,{key:e.key,modelValue:e.value,"onUpdate:modelValue":A=>e.value=A,"error-messages":t(H)[`content[${c}]`],"onClick:append":A=>c===0?t(Z)(""):t(Y)(c),"append-icon":c===0?"mdi-plus":"mdi-delete"},null,8,["modelValue","onUpdate:modelValue","error-messages","onClick:append","append-icon"]))),128)),l(_e,{label:"Publish",modelValue:t(y).value.value,"onUpdate:modelValue":a[7]||(a[7]=e=>t(y).value.value=e),"error-messages":t(y).errorMessage.value},null,8,["modelValue","error-messages"])]),_:1}),l(de,null,{default:s(()=>[l(ce),l(h,{color:"red",onClick:q,loading:t(B)},{default:s(()=>[k("Cancel")]),_:1},8,["loading"]),l(h,{color:"green",type:"submit",loading:t(B)},{default:s(()=>[k("Submit")]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["disabled","onSubmit"])]),_:1},8,["modelValue"])],64)}}};export{Ae as default};
