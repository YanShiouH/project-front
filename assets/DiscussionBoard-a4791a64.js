import{L as M,x as r,aa as U,P as E,Q as N,R as $,c as a,T as l,au as q,W as j,a9 as H,al as D,aL as O,K as C,X as o,ak as Q,ac as W,ad as X,a2 as S,ae as z,aU as G,af as J,a4 as Y,ab as Z}from"./index-3fed3b68.js";import{u as ee,a as w}from"./vee-validate.esm-5f77f2c8.js";import{c as ae,a as te,V as le}from"./index.esm-984fcf78.js";import{V as oe}from"./VContainer-9bc27829.js";import{V as se,a as T}from"./VRow-75b3fadd.js";import{V as re}from"./VTextarea-da2f43f0.js";import"./_commonjsHelpers-725317a4.js";const ne=Z("h1",{class:"text-center"},"Discussion Board",-1),Ve={__name:"DiscussionBoard",setup(ue){const b=M(),V=r(5),i=r([{key:"status",order:"desc"}]),d=r(1),f=r([]),F=[{title:"User",align:"center",sortable:!0,key:"user"},{title:"Title",align:"center",sortable:!0,key:"title"},{title:"Content",align:"center",sortable:!0,key:"content"},{title:"Date",align:"center",sortable:!0,key:"date"},{title:"Comments",align:"center",sortable:!0,key:"comments.length"},{title:"Status",align:"center",sortable:!0,key:"status"},{title:"Edit",align:"center",sortable:!1,key:"edit"}],y=r(!1),h=r(0),c=r(""),x=()=>{d.value=1,n()},n=async()=>{var s,e;y.value=!0;try{const{data:u}=await U.get("/admin/discussion/all",{params:{page:d.value,itemsPerPage:V.value,sortBy:((s=i.value[0])==null?void 0:s.key)||"_id",sortOrder:((e=i.value[0])==null?void 0:e.order)||"asc",search:c.value}});f.value.splice(0,f.value.length,...u.result.data),h.value=u.result.count}catch(u){b({text:u.response.data.message,showCloseButton:!1,snackbarProps:{timeout:2e3,color:"red",location:"bottom"}})}y.value=!1};n();const A=s=>{_.value=s._id,v.value.value=s.title,g.value.value=s.content,p.value.value=s.status,m.value=!0},m=r(!1),_=r(""),P=()=>{m.value=!1,R()},B=["Pending Approval","Approved","Rejected"],I=ae({category:te().required("Status is required").test("isCategory",s=>B.includes(s))}),{handleSubmit:L,isSubmitting:k,resetForm:R}=ee({validationSchema:I,initialValues:{title:"",content:"",category:""}}),v=w("title"),g=w("content"),p=w("category"),K=L(async s=>{try{const e=new FormData;e.append("status",s.category),await U.patch("/admin/discussion/"+_.value,e),b({text:"Review Completed",showCloseButton:!1,snackbarProps:{timeout:2e3,color:"green",location:"bottom"}}),P(),n()}catch(e){console.log(e),b({text:e.response.data.message,showCloseButton:!1,snackbarProps:{timeout:2e3,color:"red",location:"bottom"}})}});return(s,e)=>{const u=E("v-data-table-server");return N(),$(j,null,[a(oe,null,{default:l(()=>[a(se,null,{default:l(()=>[a(T,{cols:"12"},{default:l(()=>[ne]),_:1}),a(H),a(T,{cols:"12"},{default:l(()=>[a(u,{"items-per-page":V.value,"onUpdate:itemsPerPage":[e[1]||(e[1]=t=>V.value=t),n],"sort-by":i.value,"onUpdate:sortBy":[e[2]||(e[2]=t=>i.value=t),n],page:d.value,"onUpdate:page":[e[3]||(e[3]=t=>d.value=t),n],items:f.value,headers:F,loading:y.value,"items-length":h.value,search:c.value,hover:""},{top:l(()=>[a(D,{label:"Search","append-icon":"mdi-magnify","onClick:append":x,onKeydown:O(x,["enter"]),modelValue:c.value,"onUpdate:modelValue":e[0]||(e[0]=t=>c.value=t)},null,8,["onKeydown","modelValue"])]),"item.edit":l(({item:t})=>[a(C,{icon:"mdi-pencil",onClick:ie=>A(t.raw),variant:"text"},null,8,["onClick"])]),_:2},1032,["items-per-page","sort-by","page","items","loading","items-length","search"])]),_:1})]),_:1})]),_:1}),a(q,{persistent:"",modelValue:m.value,"onUpdate:modelValue":e[7]||(e[7]=t=>m.value=t),width:"500px"},{default:l(()=>[a(le,{disabled:o(k),onSubmit:Q(o(K),["prevent"])},{default:l(()=>[a(W,null,{default:l(()=>[a(X,null,{default:l(()=>[S("Article Review")]),_:1}),a(z,null,{default:l(()=>[a(D,{label:"Title",modelValue:o(v).value.value,"onUpdate:modelValue":e[4]||(e[4]=t=>o(v).value.value=t),"error-messages":o(v).errorMessage.value,readonly:""},null,8,["modelValue","error-messages"]),a(re,{label:"Content",modelValue:o(g).value.value,"onUpdate:modelValue":e[5]||(e[5]=t=>o(g).value.value=t),"error-messages":o(g).errorMessage.value,readonly:""},null,8,["modelValue","error-messages"]),a(G,{label:"Status",modelValue:o(p).value.value,"onUpdate:modelValue":e[6]||(e[6]=t=>o(p).value.value=t),"error-messages":o(p).errorMessage.value,items:B},null,8,["modelValue","error-messages"])]),_:1}),a(J,null,{default:l(()=>[a(Y),a(C,{color:"red",onClick:P,loading:o(k)},{default:l(()=>[S("Cancel")]),_:1},8,["loading"]),a(C,{color:"green",type:"submit",loading:o(k)},{default:l(()=>[S("Submit")]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["disabled","onSubmit"])]),_:1},8,["modelValue"])],64)}}};export{Ve as default};
