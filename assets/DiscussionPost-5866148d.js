import{ai as C,Q as d,S as i,T as s,c as o,aw as L,ah as u,a7 as r,a1 as n,au as N,ak as k,al as P,M as U,N as M,ay as q,L as A,x as V,an as w,a9 as j,P as z,X as c,ao as E,K,U as x,R as O,Z as Q,W,a5 as X,a6 as Z}from"./index-fe6ede13.js";import{c as G,a as H,u as J,d as Y,V as tt}from"./index.esm-c7f60be3.js";import{_ as et}from"./BackButton-160c21de.js";import{V as at}from"./VContainer-71627859.js";import{V as _,a as st}from"./VRow-4e41e806.js";import{V as ot}from"./VTextarea-3affa575.js";import"./_commonjsHelpers-725317a4.js";const D=e=>(k("data-v-c831684c"),e=e(),P(),e),nt=D(()=>u("br",null,null,-1)),lt=D(()=>u("br",null,null,-1)),ct={__name:"CommentCard",props:{_id:{type:String,default:()=>""},account:{type:String,default:()=>""},date:{type:Date,default:()=>""},content:{type:String,default:()=>""}},setup(e){return(y,p)=>(d(),i(N,{variant:"text",class:"bgColor"},{default:s(()=>[o(L,null,{default:s(()=>[u("b",null,r(e.account),1),nt,n(" "+r(e.content),1),lt,n(" "+r(new Date(e.date).toLocaleString("en-US")),1)]),_:1})]),_:1}))}},rt=C(ct,[["__scopeId","data-v-c831684c"]]);const ut=e=>(k("data-v-8cf25d56"),e=e(),P(),e),dt=ut(()=>u("br",null,null,-1)),it={class:"d-flex justify-end"},mt={class:"login-message"},_t={__name:"DiscussionPost",setup(e){const y=U(),{isLogin:p}=M(y),f=q(),v=A(),a=V({_id:"",title:"",content:"",account:"",date:"",status:""}),g=V([]);(async()=>{try{const{data:t}=await w.get("/discussion/"+f.params.id);a.value._id=t.result._id,a.value.title=t.result.title,a.value.content=t.result.content,a.value.account=t.result.account,a.value.status=t.result.status,a.value.date=t.result.date,document.title="Taealam | "+a.value.title,g.value.push(...t.commentResult)}catch(t){v({text:t.response.data.message,showCloseButton:!1,snackbarProps:{timeout:2e3,color:"red",location:"bottom"}})}})();const B=G({content:H().required("Content is required")}),{handleSubmit:I,isSubmitting:h,resetForm:R}=J({validationSchema:B,initialValues:{content:""}}),b=Y("content"),$=I(async t=>{try{const l=new FormData;l.append("content",t.content),l.append("date",new Date().toISOString()),await j.post("/discussion/"+f.params.id,l),v({text:"Submitted successfully",showCloseButton:!1,snackbarProps:{timeout:2e3,color:"green",location:"bottom"}}),R();const{data:S}=await w.get("/discussion/"+f.params.id);g.value=[...S.commentResult]}catch(l){v({text:l.response.data.message,showCloseButton:!1,snackbarProps:{timeout:2e3,color:"red",location:"bottom"}})}}),F=t=>t*50;return(t,l)=>{const S=z("router-link");return d(),i(at,null,{default:s(()=>[o(st,{class:"max-width-1080"},{default:s(()=>[o(_,{cols:"12"},{default:s(()=>[n(" Poster: "+r(a.value.account),1),dt,n(" "+r(new Date(a.value.date).toLocaleString("en-US"))+" ",1),u("h1",null,r(a.value.title),1),n(" "+r(a.value.content),1)]),_:1}),c(p)?(d(),i(_,{key:0,cols:"12"},{default:s(()=>[o(tt,{disabled:c(h),onSubmit:E(c($),["prevent"])},{default:s(()=>[o(ot,{label:"Add a Comment",modelValue:c(b).value.value,"onUpdate:modelValue":l[0]||(l[0]=m=>c(b).value.value=m),"error-messages":c(b).errorMessage.value,variant:"outlined",clearable:"",rows:"2"},null,8,["modelValue","error-messages"]),u("div",it,[o(K,{color:"primary",type:"submit",loading:c(h)},{default:s(()=>[n("Submit")]),_:1},8,["loading"])])]),_:1},8,["disabled","onSubmit"])]),_:1})):x("",!0),c(p)?x("",!0):(d(),i(_,{key:1,cols:"12",class:"text-center"},{default:s(()=>[u("p",mt,[n("Please "),o(S,{to:"/login",class:"login-link"},{default:s(()=>[n("log in")]),_:1}),n(" to leave a comment.")])]),_:1})),(d(!0),O(W,null,Q(g.value,(m,T)=>(d(),i(_,{cols:"12",key:m._id,"data-aos":"fade-down","data-aos-duration":"1200","data-aos-delay":F(T),"data-aos-offset":"-100"},{default:s(()=>[o(rt,X(Z(m)),null,16)]),_:2},1032,["data-aos-delay"]))),128))]),_:1}),o(et)]),_:1})}}},ht=C(_t,[["__scopeId","data-v-8cf25d56"]]);export{ht as default};
