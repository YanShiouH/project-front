import{_ as W,Y,Z as m,a0 as k,a1 as a,c as e,ay as q,az as A,a8 as l,ae as g,aA as h,an as x,ap as Z,aq as H,U as J,W as X,T as ee,x as d,as as ae,ag as te,o as b,$ as I,aF as oe,S as T,a3 as n,K as u,a2 as se,au as F,aG as U,R as N,a5 as le,at as ne,aD as re,aa as ue,ac as de,ad as ie}from"./index-a662182f.js";import{c as ce,a as $,u as me,d as L,V as pe}from"./index.esm-ecae4480.js";import{a as fe}from"./aos-97de04ae.js";import{V as ge}from"./VContainer-d36fccc8.js";import{a as _e,V as i}from"./VRow-81fc2a3e.js";import{V as ve}from"./VPagination-901a7f4b.js";import{V as Ve}from"./VTextarea-86cc8e3a.js";import"./_commonjsHelpers-725317a4.js";const ye=r=>(Z("data-v-8d1e1d1e"),r=r(),H(),r),Ce=ye(()=>x("br",null,null,-1)),Se={__name:"PostCard",props:{_id:{type:String,default:()=>""},account:{type:String,default:()=>""},date:{type:Date,default:()=>""},title:{type:String,default:()=>""},content:{type:String,default:()=>""}},setup(r){return(D,P)=>{const c=Y("router-link");return m(),k(c,{to:"/discussion/"+r._id,class:"text-decoration-none"},{default:a(()=>[e(q,{class:"discussion-card"},{default:a(()=>[e(A,{class:"text-primary"},{default:a(()=>[l(g(r.title),1)]),_:1}),e(h,null,{default:a(()=>[l(g(r.content),1)]),_:1}),e(h,null,{default:a(()=>[l(" Poster: "),x("b",null,g(r.account),1),Ce,l(" "+g(new Date(r.date).toLocaleString("en-US")),1)]),_:1})]),_:1})]),_:1},8,["to"])}}},we=W(Se,[["__scopeId","data-v-8d1e1d1e"]]),be=x("h1",{class:"text-center"},"Discussion Board",-1),Fe={__name:"DiscussionBoard",setup(r){fe.init();const D=J(),{isLogin:P}=X(D),c=ee(),p=d([]);(async()=>{try{const{data:o}=await ae.get("/discussion"),t=o.result.sort((s,w)=>new Date(w.date)-new Date(s.date));p.value.push(...t),console.log(o)}catch(o){c({text:o.response.data.message,showCloseButton:!1,snackbarProps:{timeout:2e3,color:"red",location:"bottom"}})}})();const f=d(!1),M=d(""),z=()=>{M.value="",f.value=!0},B=()=>{f.value=!1,G()},R=ce({title:$().required("Title is required"),content:$().required("Content is required")}),{handleSubmit:j,isSubmitting:_,resetForm:G}=me({validationSchema:R,initialValues:{title:"",content:""}}),v=L("title"),V=L("content"),Q=j(async o=>{try{const t=new FormData;t.append("title",o.title),t.append("content",o.content),t.append("date",new Date().toISOString()),await te.post("/discussion",t),c({text:"Submitted successfully",showCloseButton:!1,snackbarProps:{timeout:2e3,color:"green",location:"bottom"}}),B()}catch(t){c({text:t.response.data.message,showCloseButton:!1,snackbarProps:{timeout:2e3,color:"red",location:"bottom"}})}}),y=d(5),C=d(1),E=b(()=>{const o=(C.value-1)*y.value,t=o+y.value;return p.value.slice(o,t)}),K=b(()=>Math.ceil(p.value.length/y.value)),S=d("");b(()=>p.value.filter(o=>{const t=S.value.toLowerCase();return o.title.toLowerCase().includes(t)||o.content.toLowerCase().includes(t)}));const O=o=>o*200;return(o,t)=>(m(),I(T,null,[e(ge,null,{default:a(()=>[e(_e,{class:"max-width-1080"},{default:a(()=>[e(i,{cols:"12"},{default:a(()=>[be]),_:1}),n(P)?(m(),k(i,{key:0,cols:"12",class:"d-flex justify-end"},{default:a(()=>[e(u,{color:"secondary",onClick:z},{default:a(()=>[l("Add New Post")]),_:1})]),_:1})):se("",!0),e(i,{cols:"12"},{default:a(()=>[e(F,{modelValue:S.value,"onUpdate:modelValue":t[0]||(t[0]=s=>S.value=s),label:"Search",placeholder:"Search posts","prepend-icon":o.mdi-o.magnify},{append:a(()=>[e(U,null,{default:a(()=>[e(u,{icon:"",onClick:o.performSearch},{default:a(()=>[e(N,{color:"primary"},{default:a(()=>[l("mdi-magnify")]),_:1})]),_:1},8,["onClick"]),e(u,{icon:"",onClick:o.resetSearch},{default:a(()=>[e(N,null,{default:a(()=>[l("mdi-close")]),_:1})]),_:1},8,["onClick"])]),_:1})]),_:1},8,["modelValue","prepend-icon"])]),_:1}),e(i,{cols:"12",class:"d-flex justify-end"},{default:a(()=>[e(U,null,{default:a(()=>[e(u,{onClick:t[1]||(t[1]=s=>o.sortBy("newest"))},{default:a(()=>[l("Newest")]),_:1}),e(u,{onClick:t[2]||(t[2]=s=>o.sortBy("mostComments"))},{default:a(()=>[l("Most Comments")]),_:1})]),_:1})]),_:1}),(m(!0),I(T,null,le(E.value,(s,w)=>(m(),k(i,{cols:"12",key:s._id,"data-aos":"fade-down","data-aos-duration":"1200","data-aos-delay":O(w),"data-aos-offset":"-100"},{default:a(()=>[e(we,de(ie(s)),null,16)]),_:2},1032,["data-aos-delay"]))),128)),e(i,{cols:"12"},{default:a(()=>[e(ve,{modelValue:C.value,"onUpdate:modelValue":t[3]||(t[3]=s=>C.value=s),length:K.value,size:"20"},null,8,["modelValue","length"])]),_:1})]),_:1})]),_:1}),e(oe,{persistent:"",modelValue:f.value,"onUpdate:modelValue":t[6]||(t[6]=s=>f.value=s),width:"500px"},{default:a(()=>[e(pe,{disabled:n(_),onSubmit:ne(n(Q),["prevent"])},{default:a(()=>[e(q,null,{default:a(()=>[e(A,null,{default:a(()=>[l("Add New Post")]),_:1}),e(h,null,{default:a(()=>[e(F,{label:"Title",modelValue:n(v).value.value,"onUpdate:modelValue":t[4]||(t[4]=s=>n(v).value.value=s),"error-messages":n(v).errorMessage.value},null,8,["modelValue","error-messages"]),e(Ve,{label:"Content",modelValue:n(V).value.value,"onUpdate:modelValue":t[5]||(t[5]=s=>n(V).value.value=s),"error-messages":n(V).errorMessage.value},null,8,["modelValue","error-messages"])]),_:1}),e(re,null,{default:a(()=>[e(ue),e(u,{color:"error",onClick:B,loading:n(_)},{default:a(()=>[l("Cancel")]),_:1},8,["loading"]),e(u,{color:"primary",type:"submit",loading:n(_),variant:"elevated"},{default:a(()=>[l("Submit")]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["disabled","onSubmit"])]),_:1},8,["modelValue"])],64))}};export{Fe as default};
