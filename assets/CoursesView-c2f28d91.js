import{L as G,x as r,aa as B,P as J,Q as C,R as A,c as l,T as o,aD as Y,W as F,a9 as ee,K as h,a2 as k,af as w,aL as ae,V as le,S as I,U as te,X as t,ae as oe,an as se,ao as re,a8 as ne,ap as ue,Z as ie,as as de,a4 as ce,ab as pe,a0 as me}from"./index-c6347e45.js";import{u as ve,b as ge,a as _}from"./vee-validate.esm-9e736386.js";import{c as be,a as S,d as Ve,e as fe,V as ye}from"./index.esm-7b842741.js";import{V as Ce}from"./VContainer-e491b153.js";import{a as he,V as $}from"./VRow-cbd70931.js";import{V as ke}from"./VTextarea-efddfa6a.js";import{V as we}from"./VCheckbox-b45b6235.js";import"./_commonjsHelpers-39b5b250.js";const _e=pe("h1",{class:"text-center"},"Courses",-1),qe={__name:"CoursesView",setup(Se){const p=G(),x=r(5),m=r([{key:"title",order:"asc"}]),v=r(1),P=r([]),M=[{title:"Lesson No.",align:"center",sortable:!0,key:"lessonNo"},{title:"Topic",align:"center",sortable:!0,key:"topic"},{title:"Description",align:"center",sortable:!0,key:"description"},{title:"Content",align:"center",sortable:!0,key:"content"},{title:"Publish",align:"center",sortable:!0,key:"publish"},{title:"Edit",align:"center",sortable:!1,key:"edit"}],N=r(!1),D=r(0),g=r(""),L=()=>{v.value=1,n()},n=async()=>{var s,a;N.value=!0;try{const{data:u}=await B.get("/courses/all",{params:{page:v.value,itemsPerPage:x.value,sortBy:((s=m.value[0])==null?void 0:s.key)||"title",sortOrder:((a=m.value[0])==null?void 0:a.order)||"asc",search:g.value}});P.value.splice(0,P.value.length,...u.result.data),D.value=u.result.count}catch(u){p({text:u.response.data.message,showCloseButton:!1,snackbarProps:{timeout:2e3,color:"red",location:"bottom"}})}N.value=!1};n();const E=s=>{d.value=s._id,b.value.value=s.lessonNo,f.value.value=s.topic,V.value.value=s.description,j(s.content),y.value.value=s.publish,i.value=!0},i=r(!1),d=r(""),K=()=>{d.value="",i.value=!0},T=()=>{i.value=!1,H()},O=be({lessonNo:S().required("Lesson No. is required"),topic:S().required("Topic is required"),description:S().required("Description is required"),content:Ve().of(S().required("Content is required")),publish:fe()}),{handleSubmit:R,isSubmitting:U,resetForm:H,errors:Q}=ve({validationSchema:O,initialValues:{lessonNo:"",topic:"",description:"",content:[""],publish:!1},validateOnMount:!1}),{remove:W,push:X,fields:Z,replace:j}=ge("content"),b=_("lessonNo"),V=_("description"),f=_("topic"),y=_("publish"),z=R(async s=>{try{d.value.length>0?(await B.patch("/courses/"+d.value,s),p({text:"Updated Successfully",showCloseButton:!1,snackbarProps:{timeout:2e3,color:"green",location:"bottom"}})):(await B.post("/courses",s),p({text:"Added Successfully",showCloseButton:!1,snackbarProps:{timeout:2e3,color:"green",location:"bottom"}})),T(),n()}catch(a){p({text:a.response.data.message,showCloseButton:!1,snackbarProps:{timeout:2e3,color:"red",location:"bottom"}})}});return(s,a)=>{const u=J("v-data-table-server");return C(),A(F,null,[l(Ce,null,{default:o(()=>[l(he,null,{default:o(()=>[l($,{cols:"12"},{default:o(()=>[_e]),_:1}),l(ee),l($,{cols:"12"},{default:o(()=>[l(h,{color:"green",onClick:K},{default:o(()=>[k("Add Course")]),_:1}),l(u,{"items-per-page":x.value,"onUpdate:itemsPerPage":[a[1]||(a[1]=e=>x.value=e),n],"sort-by":m.value,"onUpdate:sortBy":[a[2]||(a[2]=e=>m.value=e),n],page:v.value,"onUpdate:page":[a[3]||(a[3]=e=>v.value=e),n],items:P.value,headers:M,loading:N.value,"items-length":D.value,search:g.value,hover:""},{top:o(()=>[l(w,{label:"Search","append-icon":"mdi-magnify","onClick:append":L,onKeydown:ae(L,["enter"]),modelValue:g.value,"onUpdate:modelValue":a[0]||(a[0]=e=>g.value=e)},null,8,["onKeydown","modelValue"])]),"item.image":o(({item:e})=>[l(le,{src:e.raw.image,height:"50px"},null,8,["src"])]),"item.publish":o(({item:e})=>[e.raw.publish?(C(),I(me,{key:0,icon:"mdi-check"})):te("",!0)]),"item.edit":o(({item:e})=>[l(h,{icon:"mdi-pencil",onClick:c=>E(e.raw),variant:"text"},null,8,["onClick"])]),_:2},1032,["items-per-page","sort-by","page","items","loading","items-length","search"])]),_:1})]),_:1})]),_:1}),l(Y,{persistent:"",modelValue:i.value,"onUpdate:modelValue":a[8]||(a[8]=e=>i.value=e),width:"500px"},{default:o(()=>[l(ye,{disabled:t(U),onSubmit:oe(t(z),["prevent"])},{default:o(()=>[l(se,{class:"dialog-card"},{default:o(()=>[l(re,null,{default:o(()=>[k(ne(d.value.length>0?"Edit Course":"Add Course"),1)]),_:1}),l(ue,null,{default:o(()=>[l(w,{label:"Lesson No.",modelValue:t(b).value.value,"onUpdate:modelValue":a[4]||(a[4]=e=>t(b).value.value=e),"error-messages":t(b).errorMessage.value},null,8,["modelValue","error-messages"]),l(w,{label:"Topic",modelValue:t(f).value.value,"onUpdate:modelValue":a[5]||(a[5]=e=>t(f).value.value=e),"error-messages":t(f).errorMessage.value},null,8,["modelValue","error-messages"]),l(ke,{label:"Description",modelValue:t(V).value.value,"onUpdate:modelValue":a[6]||(a[6]=e=>t(V).value.value=e),"error-messages":t(V).errorMessage.value},null,8,["modelValue","error-messages"]),(C(!0),A(F,null,ie(t(Z),(e,c)=>(C(),I(w,{key:e.key,modelValue:e.value,"onUpdate:modelValue":q=>e.value=q,"error-messages":t(Q)[`content[${c}]`],"onClick:append":q=>c===0?t(X)(""):t(W)(c),"append-icon":c===0?"mdi-plus":"mdi-delete"},null,8,["modelValue","onUpdate:modelValue","error-messages","onClick:append","append-icon"]))),128)),l(we,{label:"Publish",modelValue:t(y).value.value,"onUpdate:modelValue":a[7]||(a[7]=e=>t(y).value.value=e),"error-messages":t(y).errorMessage.value},null,8,["modelValue","error-messages"])]),_:1}),l(de,null,{default:o(()=>[l(ce),l(h,{color:"red",onClick:T,loading:t(U)},{default:o(()=>[k("Cancel")]),_:1},8,["loading"]),l(h,{color:"green",type:"submit",loading:t(U)},{default:o(()=>[k("Submit")]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["disabled","onSubmit"])]),_:1},8,["modelValue"])],64)}}};export{qe as default};
