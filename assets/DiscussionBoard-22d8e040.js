import{_ as A,P as Y,Q as m,S as h,T as o,c as t,ak as R,al as z,a2 as r,a8 as v,am as D,ai as k,ao as K,ap as O,M as ee,N as te,L as ae,x as d,ar as oe,aa as se,o as b,R as U,aw as le,W as L,X as n,K as c,U as ne,at as $,aB as re,aC as de,Z as ue,as as ie,an as ce,a4 as me,a6 as pe,a7 as fe}from"./index-29ec8142.js";import{c as ve,a as M,u as ge,d as q,V as _e}from"./index.esm-f14efa99.js";import{F as Ve}from"./footeR-35e213d2.js";import{a as ye}from"./aos-97de04ae.js";import{V as we}from"./VContainer-3a71f8e2.js";import{V as Se,a as u}from"./VRow-6774478f.js";import{V as xe}from"./VPagination-447ea5b4.js";import{V as Ce}from"./VTextarea-4df86f48.js";import"./_commonjsHelpers-725317a4.js";const be=l=>(K("data-v-4383e954"),l=l(),O(),l),he=be(()=>k("br",null,null,-1)),De={__name:"PostCard",props:{_id:{type:String,default:()=>""},account:{type:String,default:()=>""},date:{type:Date,default:()=>""},title:{type:String,default:()=>""},content:{type:String,default:()=>""}},setup(l){return(P,B)=>{const i=Y("router-link");return m(),h(i,{to:"/discussion/"+l._id,class:"text-decoration-none"},{default:o(()=>[t(R,{class:"discussion-card"},{default:o(()=>[t(z,{class:"text-primary"},{default:o(()=>[r(v(l.title),1)]),_:1}),t(D,null,{default:o(()=>[r(v(l.content),1)]),_:1}),t(D,null,{default:o(()=>[r(" Poster: "),k("b",null,v(l.account),1),he,r(" "+v(new Date(l.date).toLocaleString("en-US")),1)]),_:1})]),_:1})]),_:1},8,["to"])}}},ke=A(De,[["__scopeId","data-v-4383e954"]]);const Pe=l=>(K("data-v-66356616"),l=l(),O(),l),Be=Pe(()=>k("h1",{class:"text-center"},"Discussion Board",-1)),Ie={__name:"DiscussionBoard",setup(l){ye.init();const P=ee(),{isLogin:B}=te(P),i=ae(),I=d([]),g=d(0);(async()=>{try{const{data:s}=await oe.get("/discussion");console.log(s);const e=s.result.sort((a,C)=>new Date(a.date)-new Date(C.date));console.log(e),I.value.push(...e)}catch(s){i({text:s.response.data.message,showCloseButton:!1,snackbarProps:{timeout:2e3,color:"red",location:"bottom"}})}})();const p=d(!1),Q=d(""),j=()=>{Q.value="",p.value=!0},N=()=>{p.value=!1,W()},J=ve({title:M().required("Title is required"),content:M().required("Content is required")}),{handleSubmit:E,isSubmitting:_,resetForm:W}=ge({validationSchema:J,initialValues:{title:"",content:""}}),V=q("title"),y=q("content"),X=E(async s=>{try{const e=new FormData;e.append("title",s.title),e.append("content",s.content),e.append("date",new Date().toISOString()),await se.post("/discussion",e),i({text:"Submitted successfully",showCloseButton:!1,snackbarProps:{timeout:2e3,color:"green",location:"bottom"}}),N()}catch(e){i({text:e.response.data.message,showCloseButton:!1,snackbarProps:{timeout:2e3,color:"red",location:"bottom"}})}}),Z=s=>s*50,f=d(""),w=d(""),T=s=>{w.value=s},F=b(()=>{let s=JSON.parse(JSON.stringify(I.value));return w.value.length>0&&(s=s.filter(e=>{const a=w.value.trim().toLowerCase();return e.title.toLowerCase().includes(a)||e.content.toLowerCase().includes(a)})),g.value===0?s=s.sort((e,a)=>new Date(a.date)-new Date(e.date)):s=s.sort((e,a)=>a.comments.length-e.comments.length),s}),S=d(5),x=d(1),G=b(()=>Math.ceil(F.value.length/S.value)),H=b(()=>{const s=(x.value-1)*S.value,e=s+S.value;return F.value.slice(s,e)});return(s,e)=>(m(),U(L,null,[t(we,{style:{height:"calc(100% - 41px)"}},{default:o(()=>[t(Se,{class:"max-width-1080"},{default:o(()=>[t(u,{cols:"12"},{default:o(()=>[Be]),_:1}),n(B)?(m(),h(u,{key:0,cols:"12",class:"d-flex justify-end"},{default:o(()=>[t(c,{color:"secondary",onClick:j},{default:o(()=>[r("Add New Post")]),_:1})]),_:1})):ne("",!0),t(u,{cols:"5",sm:"8",lg:"9"},{default:o(()=>[t($,{modelValue:f.value,"onUpdate:modelValue":e[0]||(e[0]=a=>f.value=a),placeholder:"Search...","append-inner-icon":"mdi-magnify",variant:"filled",density:"compact","onClick:appendInner":e[1]||(e[1]=a=>T(f.value)),onKeydown:e[2]||(e[2]=re(a=>T(f.value),["enter"]))},null,8,["modelValue"])]),_:1}),t(u,{cols:"7",sm:"4",lg:"3",class:"d-flex justify-end"},{default:o(()=>[t(de,{modelValue:g.value,"onUpdate:modelValue":e[3]||(e[3]=a=>g.value=a),divided:"",variant:"outlined"},{default:o(()=>[t(c,{variant:"outlined"},{default:o(()=>[r("Newest")]),_:1}),t(c,{variant:"outlined"},{default:o(()=>[r("Popular")]),_:1})]),_:1},8,["modelValue"])]),_:1}),(m(!0),U(L,null,ue(H.value,(a,C)=>(m(),h(u,{cols:"12",key:a._id,"data-aos":"fade-down","data-aos-duration":"600","data-aos-delay":Z(C),"data-aos-offset":"-100"},{default:o(()=>[t(ke,pe(fe(a)),null,16)]),_:2},1032,["data-aos-delay"]))),128)),t(u,{cols:"12"},{default:o(()=>[t(xe,{modelValue:x.value,"onUpdate:modelValue":e[4]||(e[4]=a=>x.value=a),length:G.value,size:"20"},null,8,["modelValue","length"])]),_:1})]),_:1})]),_:1}),t(Ve),t(le,{persistent:"",modelValue:p.value,"onUpdate:modelValue":e[7]||(e[7]=a=>p.value=a),width:"500px"},{default:o(()=>[t(_e,{disabled:n(_),onSubmit:ie(n(X),["prevent"])},{default:o(()=>[t(R,null,{default:o(()=>[t(z,null,{default:o(()=>[r("Add New Post")]),_:1}),t(D,null,{default:o(()=>[t($,{label:"Title",modelValue:n(V).value.value,"onUpdate:modelValue":e[5]||(e[5]=a=>n(V).value.value=a),"error-messages":n(V).errorMessage.value},null,8,["modelValue","error-messages"]),t(Ce,{label:"Content",modelValue:n(y).value.value,"onUpdate:modelValue":e[6]||(e[6]=a=>n(y).value.value=a),"error-messages":n(y).errorMessage.value},null,8,["modelValue","error-messages"])]),_:1}),t(ce,null,{default:o(()=>[t(me),t(c,{color:"error",onClick:N,loading:n(_)},{default:o(()=>[r("Cancel")]),_:1},8,["loading"]),t(c,{color:"primary",type:"submit",loading:n(_),variant:"elevated"},{default:o(()=>[r("Submit")]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["disabled","onSubmit"])]),_:1},8,["modelValue"])],64))}},Re=A(Ie,[["__scopeId","data-v-66356616"]]);export{Re as default};
