import{L as M,x as r,aa as U,P as E,Q as N,R as $,c as a,T as l,az as q,W as j,a9 as z,ao as D,aY as H,K as k,X as s,an as O,as as Q,at as W,a2 as S,au as X,b5 as Y,ax as G,a4 as J,ah as Z}from"./index-546107a1.js";import{c as ee,a as ae,u as te,d as w,V as le}from"./index.esm-95a4c6c7.js";import{V as se}from"./VContainer-12d4fb26.js";import{a as oe,V as T}from"./VRow-ffbd189e.js";import{V as re}from"./VTextarea-8e6ca934.js";import"./_commonjsHelpers-725317a4.js";const ne=Z("h1",{class:"text-center"},"Discussion Board",-1),be={__name:"DiscussionBoard",setup(ue){const b=M(),V=r(5),i=r([{key:"status",order:"desc"}]),d=r(1),f=r([]),F=[{title:"User",align:"center",sortable:!0,key:"user"},{title:"Title",align:"center",sortable:!0,key:"title"},{title:"Content",align:"center",sortable:!0,key:"content"},{title:"Date",align:"center",sortable:!0,key:"date"},{title:"Comments",align:"center",sortable:!0,key:"comments.length"},{title:"Status",align:"center",sortable:!0,key:"status"},{title:"Edit",align:"center",sortable:!1,key:"edit"}],y=r(!1),h=r(0),c=r(""),x=()=>{d.value=1,n()},n=async()=>{var o,e;y.value=!0;try{const{data:u}=await U.get("/admin/discussion/all",{params:{page:d.value,itemsPerPage:V.value,sortBy:((o=i.value[0])==null?void 0:o.key)||"_id",sortOrder:((e=i.value[0])==null?void 0:e.order)||"asc",search:c.value}});f.value.splice(0,f.value.length,...u.result.data),h.value=u.result.count}catch(u){b({text:u.response.data.message,showCloseButton:!1,snackbarProps:{timeout:2e3,color:"red",location:"bottom"}})}y.value=!1};n();const A=o=>{_.value=o._id,v.value.value=o.title,g.value.value=o.content,p.value.value=o.status,m.value=!0},m=r(!1),_=r(""),P=()=>{m.value=!1,K()},B=["Pending Approval","Approved","Rejected"],I=ee({category:ae().required("Status is required").test("isCategory",o=>B.includes(o))}),{handleSubmit:R,isSubmitting:C,resetForm:K}=te({validationSchema:I,initialValues:{title:"",content:"",category:""}}),v=w("title"),g=w("content"),p=w("category"),L=R(async o=>{try{const e=new FormData;e.append("status",o.category),await U.patch("/admin/discussion/"+_.value,e),b({text:"Review Completed",showCloseButton:!1,snackbarProps:{timeout:2e3,color:"green",location:"bottom"}}),P(),n()}catch(e){console.log(e),b({text:e.response.data.message,showCloseButton:!1,snackbarProps:{timeout:2e3,color:"red",location:"bottom"}})}});return(o,e)=>{const u=E("v-data-table-server");return N(),$(j,null,[a(se,null,{default:l(()=>[a(oe,null,{default:l(()=>[a(T,{cols:"12"},{default:l(()=>[ne]),_:1}),a(z),a(T,{cols:"12"},{default:l(()=>[a(u,{"items-per-page":V.value,"onUpdate:itemsPerPage":[e[1]||(e[1]=t=>V.value=t),n],"sort-by":i.value,"onUpdate:sortBy":[e[2]||(e[2]=t=>i.value=t),n],page:d.value,"onUpdate:page":[e[3]||(e[3]=t=>d.value=t),n],items:f.value,headers:F,loading:y.value,"items-length":h.value,search:c.value,hover:""},{top:l(()=>[a(D,{label:"Search","append-icon":"mdi-magnify","onClick:append":x,onKeydown:H(x,["enter"]),modelValue:c.value,"onUpdate:modelValue":e[0]||(e[0]=t=>c.value=t)},null,8,["onKeydown","modelValue"])]),"item.edit":l(({item:t})=>[a(k,{icon:"mdi-pencil",onClick:ie=>A(t.raw),variant:"text"},null,8,["onClick"])]),_:2},1032,["items-per-page","sort-by","page","items","loading","items-length","search"])]),_:1})]),_:1})]),_:1}),a(q,{persistent:"",modelValue:m.value,"onUpdate:modelValue":e[7]||(e[7]=t=>m.value=t),width:"500px"},{default:l(()=>[a(le,{disabled:s(C),onSubmit:O(s(L),["prevent"])},{default:l(()=>[a(Q,null,{default:l(()=>[a(W,null,{default:l(()=>[S("Article Review")]),_:1}),a(X,null,{default:l(()=>[a(D,{label:"Title",modelValue:s(v).value.value,"onUpdate:modelValue":e[4]||(e[4]=t=>s(v).value.value=t),"error-messages":s(v).errorMessage.value,readonly:""},null,8,["modelValue","error-messages"]),a(re,{label:"Content",modelValue:s(g).value.value,"onUpdate:modelValue":e[5]||(e[5]=t=>s(g).value.value=t),"error-messages":s(g).errorMessage.value,readonly:""},null,8,["modelValue","error-messages"]),a(Y,{label:"Status",modelValue:s(p).value.value,"onUpdate:modelValue":e[6]||(e[6]=t=>s(p).value.value=t),"error-messages":s(p).errorMessage.value,items:B},null,8,["modelValue","error-messages"])]),_:1}),a(G,null,{default:l(()=>[a(J),a(k,{color:"red",onClick:P,loading:s(C)},{default:l(()=>[S("Cancel")]),_:1},8,["loading"]),a(k,{color:"green",type:"submit",loading:s(C)},{default:l(()=>[S("Submit")]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["disabled","onSubmit"])]),_:1},8,["modelValue"])],64)}}};export{be as default};
